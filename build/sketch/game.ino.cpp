#include <Arduino.h>
#line 1 "/Users/gabriel/Documents/Arduino/game/game.ino"
// #define I2C_SDA_PIN 22
// #define I2C_SCL_PIN 18
// #include <Adafruit_seesaw.h>
#include <ArduinoJson.h>
#include <SPI.h>
#include <SD.h>
#include "AudioTools.h"
#include "AudioTools/AudioLibs/AudioBoardStream.h"
#include "AudioTools/AudioCodecs/CodecMP3Helix.h"
// #define FASTLED_RMT_BUILTIN_DRIVER 1
// #define FASTLED_FORCE_SOFTWARE_SPI
#include <FastLED.h>
// #define FULL_DMA_BUFFER
// #include "I2SClocklessLedDriver.h"

#define NUM_LEDS 120
#define NUM_COLS 4
#define WINDOW_LENGTH 5.0
#define ZERO_WIDTH 0.25
#define BRIGHTNESS 10
// #define BUTTON_1_PIN 36
// #define BUTTON_2_PIN 13
// #define BUTTON_3_PIN 19
// #define BUTTON_4_PIN 23
#define BUTTON_1_PIN 13
#define BUTTON_2_PIN 18
#define BUTTON_3_PIN 19
#define BUTTON_4_PIN 23
#define TASER_PIN 5
#define PIANO_DEBOUNCE_DELAY 0.25 // 0.25 seconds debounce
// #define PIANO_THRESHOLD 4.0 / WINDOW_LENGTH
#define PIANO_THRESHOLD 2
#define MAX_FAILURES 5

enum NoteColumn
{
  PIANO_NOTE_D,
  PIANO_NOTE_F,
  PIANO_NOTE_J,
  PIANO_NOTE_K
};

const CHSV colColors[4] = {
    CHSV(96, 255, 255),  // Column for "d" (Greenish)
    CHSV(0, 255, 255),   // Column for "f" (Red)
    CHSV(160, 255, 255), // Column for "j" (Blue-ish)
    CHSV(32, 255, 255)   // Column for "k" (Orange)
};

const CHSV colColorsLighter[4] = {
    CHSV(116, 255, 255),  // Lighter green
    CHSV(20, 255, 255),   // Lighter red
    CHSV(180, 255, 255), // Lighter blue-ish
    CHSV(52, 255, 255)   // Lighter orange
};

float lastHit[4] = {0.0, 0.0, 0.0, 0.0};

const CHSV redColor = CHSV(0, 255, 255);

const int chipSelect = PIN_AUDIO_KIT_SD_CARD_CS;
AudioBoardStream i2s(AudioKitEs8388V1);                  // final output of decoded stream
EncodedAudioStream decoder(&i2s, new MP3DecoderHelix()); // Decoding stream
// Adafruit_seesaw ss;
StreamCopy copier;
File audioFile;
File songConfigFile;
CRGBArray<NUM_LEDS> leds;
// uint8_t leds[NUM_LEDS];
TaskHandle_t audioTask;
// I2SClocklessLedDriver driver;
int correctButtonPresses = 0;
int incorrectButtonPresses = 0;
unsigned long damageUntil = 0;
int incorrectHits = 0;
int correctHits = 0;
bool gameOn = false;
bool taserActivated = false;
bool pianoLoading = false;
// You can customize the column colors here:

typedef struct
{
  float time;     // When the note starts.
  float height;   // How long the note lasts.
  NoteColumn col; // Which column (d, f, j, or k).
  CHSV color;     // The color of the note.
  bool hit;
  bool recognizedNotHit;
} piano_note_t;

typedef struct
{
  const char *srcref;
  const float length;
  const int noteCount;
  const char *mapping;
} piano_game_t;

// you belong w me,
// bang,
// rick
piano_game_t piano_games[] = {
    {"a7xmtBHWgE", 224.82, 349, "{\"version\":1,\"title\":\"\",\"startAt\":null,\"endAt\":null,\"keys\":4,\"difficulty\":1,\"length\":224.82,\"noteCount\":349,\"visualizerName\":\"\",\"clonedFrom\":\"\",\"mappings\":[{\"t\":9.286,\"k\":\"d\"},{\"t\":12.425,\"k\":\"f\"},{\"t\":15.333,\"k\":\"j\"},{\"t\":17.267,\"k\":\"k\"},{\"t\":18.957,\"k\":\"f\"},{\"t\":19.785,\"k\":\"f\"},{\"t\":25.614,\"k\":\"d\"},{\"t\":28.868,\"k\":\"j\"},{\"t\":32.015,\"k\":\"d\"},{\"t\":32.205,\"k\":\"k\"},{\"t\":33.772,\"k\":\"d\",\"h\":{\"d\":34.73636401335144}},{\"t\":36.69,\"k\":\"k\",\"h\":{\"k\":38.032124908447265}},{\"t\":39.113,\"k\":\"f\",\"h\":{\"f\":40.41450008392334}},{\"t\":42.247,\"k\":\"j\",\"h\":{\"j\":43.47073504196167}},{\"t\":44.251,\"k\":\"d\",\"h\":{\"d\":45.48130982643127}},{\"t\":51.135,\"k\":\"k\",\"h\":{\"k\":52.39404503433227}},{\"t\":51.197,\"k\":\"d\",\"h\":{\"d\":52.44504491416931}},{\"t\":53.265,\"k\":\"k\",\"h\":{\"k\":53.59533594087219}},{\"t\":53.732,\"k\":\"k\",\"h\":{\"k\":54.95999795422363}},{\"t\":55.087,\"k\":\"k\",\"h\":{\"k\":57.646980091552734}},{\"t\":60.27,\"k\":\"d\"},{\"t\":60.564,\"k\":\"k\"},{\"t\":60.901,\"k\":\"k\"},{\"t\":61.282,\"k\":\"k\"},{\"t\":61.396,\"k\":\"d\"},{\"t\":61.603,\"k\":\"k\"},{\"t\":61.865,\"k\":\"d\"},{\"t\":62.13,\"k\":\"k\"},{\"t\":62.507,\"k\":\"d\"},{\"t\":62.74,\"k\":\"k\"},{\"t\":62.998,\"k\":\"d\"},{\"t\":63.189,\"k\":\"k\"},{\"t\":63.793,\"k\":\"d\"},{\"t\":63.964,\"k\":\"k\"},{\"t\":64.635,\"k\":\"j\"},{\"t\":65.298,\"k\":\"f\"},{\"t\":65.488,\"k\":\"j\"},{\"t\":65.733,\"k\":\"f\"},{\"t\":67.365,\"k\":\"j\"},{\"t\":67.49,\"k\":\"f\"},{\"t\":67.687,\"k\":\"j\"},{\"t\":69.342,\"k\":\"d\"},{\"t\":69.485,\"k\":\"k\"},{\"t\":70.484,\"k\":\"j\"},{\"t\":71.001,\"k\":\"d\"},{\"t\":72.117,\"k\":\"f\"},{\"t\":72.743,\"k\":\"d\"},{\"t\":73.337,\"k\":\"d\"},{\"t\":73.629,\"k\":\"d\"},{\"t\":73.865,\"k\":\"d\"},{\"t\":74.17,\"k\":\"d\",\"h\":{\"d\":75.59835706294251}},{\"t\":76.168,\"k\":\"j\",\"h\":{\"j\":79.56983505149842}},{\"t\":77.869,\"k\":\"d\",\"h\":{\"d\":79.56083498855591}},{\"t\":80.876,\"k\":\"d\"},{\"t\":81.51,\"k\":\"k\"},{\"t\":82.217,\"k\":\"j\"},{\"t\":83.604,\"k\":\"d\"},{\"t\":85.121,\"k\":\"d\"},{\"t\":85.419,\"k\":\"f\"},{\"t\":86.509,\"k\":\"k\"},{\"t\":87.053,\"k\":\"k\"},{\"t\":87.412,\"k\":\"k\"},{\"t\":87.606,\"k\":\"k\"},{\"t\":87.832,\"k\":\"k\"},{\"t\":88.045,\"k\":\"k\"},{\"t\":88.296,\"k\":\"k\"},{\"t\":89.762,\"k\":\"f\"},{\"t\":90.147,\"k\":\"d\"},{\"t\":92,\"k\":\"k\"},{\"t\":92.449,\"k\":\"j\"},{\"t\":93.086,\"k\":\"k\"},{\"t\":93.347,\"k\":\"k\"},{\"t\":93.748,\"k\":\"j\"},{\"t\":93.936,\"k\":\"j\"},{\"t\":94.229,\"k\":\"j\"},{\"t\":94.482,\"k\":\"j\"},{\"t\":94.616,\"k\":\"f\"},{\"t\":94.963,\"k\":\"j\"},{\"t\":95.362,\"k\":\"f\"},{\"t\":95.911,\"k\":\"f\"},{\"t\":96.092,\"k\":\"j\"},{\"t\":96.326,\"k\":\"f\"},{\"t\":96.515,\"k\":\"j\"},{\"t\":96.729,\"k\":\"f\"},{\"t\":96.893,\"k\":\"k\"},{\"t\":97.078,\"k\":\"f\"},{\"t\":97.267,\"k\":\"k\"},{\"t\":97.446,\"k\":\"f\"},{\"t\":97.65,\"k\":\"j\"},{\"t\":97.793,\"k\":\"f\"},{\"t\":98.003,\"k\":\"j\"},{\"t\":98.213,\"k\":\"f\"},{\"t\":98.364,\"k\":\"k\"},{\"t\":98.75,\"k\":\"f\"},{\"t\":99.136,\"k\":\"j\"},{\"t\":99.686,\"k\":\"d\"},{\"t\":100.148,\"k\":\"d\"},{\"t\":100.544,\"k\":\"d\"},{\"t\":100.923,\"k\":\"d\"},{\"t\":101.361,\"k\":\"d\"},{\"t\":101.835,\"k\":\"k\",\"h\":{\"k\":103.51463488746643}},{\"t\":103.764,\"k\":\"f\",\"h\":{\"f\":104.74087892179871}},{\"t\":106.078,\"k\":\"j\",\"h\":{\"j\":108.95916378446961}},{\"t\":109.286,\"k\":\"d\",\"h\":{\"d\":110.16422187792969}},{\"t\":110.092,\"k\":\"k\",\"h\":{\"k\":111.51699904577637}},{\"t\":111.571,\"k\":\"d\"},{\"t\":111.715,\"k\":\"k\",\"h\":{\"k\":112.0663579332428}},{\"t\":112.024,\"k\":\"d\",\"h\":{\"d\":112.34210492370606}},{\"t\":112.482,\"k\":\"k\"},{\"t\":112.684,\"k\":\"d\"},{\"t\":112.902,\"k\":\"j\",\"h\":{\"j\":113.38409218119811}},{\"t\":113.393,\"k\":\"f\",\"h\":{\"f\":113.71581616593933}},{\"t\":115.025,\"k\":\"k\",\"h\":{\"k\":115.44150289700318}},{\"t\":115.428,\"k\":\"d\"},{\"t\":115.632,\"k\":\"k\",\"h\":{\"k\":116.08103807057189}},{\"t\":116.377,\"k\":\"j\"},{\"t\":116.745,\"k\":\"j\"},{\"t\":116.931,\"k\":\"j\"},{\"t\":117.096,\"k\":\"j\"},{\"t\":117.258,\"k\":\"j\"},{\"t\":117.414,\"k\":\"j\"},{\"t\":117.745,\"k\":\"j\",\"h\":{\"j\":119.7414520553131}},{\"t\":119.995,\"k\":\"d\",\"h\":{\"d\":120.43039704768371}},{\"t\":120.364,\"k\":\"f\",\"h\":{\"f\":121.06434917929077}},{\"t\":122.95,\"k\":\"d\",\"h\":{\"d\":123.49254704768371}},{\"t\":123.246,\"k\":\"k\",\"h\":{\"k\":124.24471597138977}},{\"t\":124.405,\"k\":\"d\"},{\"t\":124.903,\"k\":\"d\"},{\"t\":125.485,\"k\":\"kf\",\"h\":{\"k\":125.96284880545043}},{\"t\":125.844,\"k\":\"f\"},{\"t\":126.079,\"k\":\"j\",\"h\":{\"j\":126.44314616403199}},{\"t\":126.312,\"k\":\"d\"},{\"t\":126.579,\"k\":\"k\"},{\"t\":126.761,\"k\":\"f\"},{\"t\":126.961,\"k\":\"j\"},{\"t\":127.194,\"k\":\"d\"},{\"t\":127.575,\"k\":\"d\"},{\"t\":128.009,\"k\":\"j\",\"h\":{\"j\":128.324096}},{\"t\":128.195,\"k\":\"f\",\"h\":{\"f\":128.52977705722046}},{\"t\":128.509,\"k\":\"j\"},{\"t\":128.783,\"k\":\"fk\"},{\"t\":129.045,\"k\":\"k\"},{\"t\":129.286,\"k\":\"d\",\"h\":{\"d\":129.63016516403198}},{\"t\":129.531,\"k\":\"k\"},{\"t\":129.744,\"k\":\"j\"},{\"t\":129.953,\"k\":\"d\"},{\"t\":130.13,\"k\":\"k\"},{\"t\":130.5,\"k\":\"kf\",\"h\":{\"f\":130.8910600858307}},{\"t\":130.763,\"k\":\"j\",\"h\":{\"j\":131.28472186839295}},{\"t\":131.447,\"k\":\"j\",\"h\":{\"j\":133.03359397329712}},{\"t\":133.297,\"k\":\"k\",\"h\":{\"k\":134.19916689891053}},{\"t\":134.121,\"k\":\"d\",\"h\":{\"d\":134.87569801335144}},{\"t\":134.992,\"k\":\"f\",\"h\":{\"f\":135.53196601335145}},{\"t\":135.55,\"k\":\"j\"},{\"t\":136.027,\"k\":\"j\"},{\"t\":136.484,\"k\":\"k\",\"h\":{\"k\":136.84375505340577}},{\"t\":137.061,\"k\":\"f\",\"h\":{\"f\":137.73667000953674}},{\"t\":138.375,\"k\":\"d\",\"h\":{\"d\":138.79716491607667}},{\"t\":138.732,\"k\":\"k\",\"h\":{\"k\":139.42555500572203}},{\"t\":139.231,\"k\":\"f\",\"h\":{\"f\":139.9238079408722}},{\"t\":139.712,\"k\":\"j\",\"h\":{\"j\":140.50523589318848}},{\"t\":141.71,\"k\":\"f\",\"h\":{\"f\":142.10464093515014}},{\"t\":141.994,\"k\":\"k\"},{\"t\":142.354,\"k\":\"dk\",\"h\":{\"k\":142.83133000190736}},{\"t\":142.933,\"k\":\"d\",\"h\":{\"d\":143.85835802098083}},{\"t\":143.811,\"k\":\"k\",\"h\":{\"k\":144.68766395994567}},{\"t\":143.945,\"k\":\"f\"},{\"t\":145.14,\"k\":\"j\",\"h\":{\"j\":145.58430395803833}},{\"t\":145.622,\"k\":\"f\"},{\"t\":145.808,\"k\":\"k\",\"h\":{\"k\":146.20557487220765}},{\"t\":146.09,\"k\":\"f\"},{\"t\":146.71,\"k\":\"d\"},{\"t\":147.091,\"k\":\"d\"},{\"t\":148.499,\"k\":\"k\"},{\"t\":148.744,\"k\":\"k\"},{\"t\":148.949,\"k\":\"k\"},{\"t\":149.149,\"k\":\"k\"},{\"t\":149.349,\"k\":\"k\"},{\"t\":149.558,\"k\":\"k\"},{\"t\":149.75,\"k\":\"k\"},{\"t\":149.944,\"k\":\"k\"},{\"t\":150.161,\"k\":\"k\"},{\"t\":150.596,\"k\":\"j\"},{\"t\":151.144,\"k\":\"f\",\"h\":{\"f\":151.8226101449585}},{\"t\":151.941,\"k\":\"d\"},{\"t\":152.341,\"k\":\"d\",\"h\":{\"d\":152.71926001716614}},{\"t\":152.686,\"k\":\"k\",\"h\":{\"k\":152.9948800076294}},{\"t\":152.89,\"k\":\"d\"},{\"t\":153.101,\"k\":\"k\"},{\"t\":153.275,\"k\":\"d\"},{\"t\":153.424,\"k\":\"k\"},{\"t\":153.611,\"k\":\"dk\"},{\"t\":153.861,\"k\":\"kd\"},{\"t\":154.091,\"k\":\"k\"},{\"t\":154.193,\"k\":\"d\"},{\"t\":154.339,\"k\":\"k\"},{\"t\":154.516,\"k\":\"k\"},{\"t\":154.574,\"k\":\"d\"},{\"t\":154.726,\"k\":\"k\"},{\"t\":154.897,\"k\":\"d\"},{\"t\":154.949,\"k\":\"k\"},{\"t\":155.128,\"k\":\"k\"},{\"t\":155.246,\"k\":\"d\",\"h\":{\"d\":157.0774719847412}},{\"t\":155.356,\"k\":\"k\",\"h\":{\"k\":157.0834717882843}},{\"t\":158.095,\"k\":\"kd\",\"h\":{\"k\":158.92853892179872,\"d\":158.93753898474122}},{\"t\":159.273,\"k\":\"kd\"},{\"t\":159.444,\"k\":\"k\"},{\"t\":159.5,\"k\":\"d\"},{\"t\":159.643,\"k\":\"k\"},{\"t\":159.743,\"k\":\"d\"},{\"t\":159.842,\"k\":\"k\"},{\"t\":159.975,\"k\":\"d\"},{\"t\":160.026,\"k\":\"k\"},{\"t\":160.211,\"k\":\"dk\"},{\"t\":160.443,\"k\":\"kd\"},{\"t\":160.66,\"k\":\"k\"},{\"t\":160.719,\"k\":\"d\"},{\"t\":160.894,\"k\":\"k\"},{\"t\":160.98,\"k\":\"d\"},{\"t\":161.112,\"k\":\"k\"},{\"t\":161.21,\"k\":\"d\"},{\"t\":161.327,\"k\":\"k\"},{\"t\":161.44,\"k\":\"d\"},{\"t\":161.519,\"k\":\"k\"},{\"t\":161.705,\"k\":\"dk\"},{\"t\":161.909,\"k\":\"k\"},{\"t\":161.975,\"k\":\"d\"},{\"t\":162.196,\"k\":\"j\"},{\"t\":162.325,\"k\":\"f\"},{\"t\":162.499,\"k\":\"j\"},{\"t\":162.699,\"k\":\"fj\"},{\"t\":162.949,\"k\":\"j\"},{\"t\":163.147,\"k\":\"j\"},{\"t\":163.339,\"k\":\"j\"},{\"t\":163.515,\"k\":\"j\"},{\"t\":163.705,\"k\":\"j\"},{\"t\":163.922,\"k\":\"j\"},{\"t\":164.135,\"k\":\"j\"},{\"t\":164.36,\"k\":\"j\"},{\"t\":164.56,\"k\":\"j\"},{\"t\":164.792,\"k\":\"fj\"},{\"t\":165.039,\"k\":\"f\"},{\"t\":165.108,\"k\":\"j\"},{\"t\":165.292,\"k\":\"fj\"},{\"t\":165.489,\"k\":\"fj\"},{\"t\":168.48,\"k\":\"jd\"},{\"t\":168.661,\"k\":\"j\"},{\"t\":168.714,\"k\":\"d\"},{\"t\":168.855,\"k\":\"j\"},{\"t\":168.924,\"k\":\"d\"},{\"t\":169.05,\"k\":\"j\"},{\"t\":169.166,\"k\":\"d\"},{\"t\":169.258,\"k\":\"j\"},{\"t\":169.405,\"k\":\"d\"},{\"t\":169.479,\"k\":\"j\"},{\"t\":169.656,\"k\":\"dj\"},{\"t\":169.9,\"k\":\"jd\"},{\"t\":170.108,\"k\":\"j\"},{\"t\":170.176,\"k\":\"d\"},{\"t\":170.338,\"k\":\"j\"},{\"t\":170.426,\"k\":\"d\"},{\"t\":170.555,\"k\":\"j\"},{\"t\":170.725,\"k\":\"d\"},{\"t\":171.021,\"k\":\"j\"},{\"t\":171.276,\"k\":\"d\"},{\"t\":171.874,\"k\":\"f\"},{\"t\":173.398,\"k\":\"f\"},{\"t\":173.845,\"k\":\"f\"},{\"t\":174.21,\"k\":\"f\"},{\"t\":174.472,\"k\":\"k\"},{\"t\":175.306,\"k\":\"k\"},{\"t\":175.505,\"k\":\"k\"},{\"t\":176.992,\"k\":\"d\"},{\"t\":179.054,\"k\":\"f\"},{\"t\":180.892,\"k\":\"j\"},{\"t\":182.122,\"k\":\"k\"},{\"t\":182.711,\"k\":\"k\"},{\"t\":183.217,\"k\":\"k\"},{\"t\":184.007,\"k\":\"k\"},{\"t\":184.255,\"k\":\"k\"},{\"t\":184.52,\"k\":\"k\"},{\"t\":185.555,\"k\":\"k\"},{\"t\":185.728,\"k\":\"k\"},{\"t\":185.904,\"k\":\"k\"},{\"t\":186.061,\"k\":\"k\"},{\"t\":186.294,\"k\":\"k\"},{\"t\":186.479,\"k\":\"k\"},{\"t\":186.871,\"k\":\"k\"},{\"t\":187.041,\"k\":\"k\"},{\"t\":187.271,\"k\":\"k\"},{\"t\":187.486,\"k\":\"k\"},{\"t\":187.691,\"k\":\"k\"},{\"t\":187.906,\"k\":\"k\"},{\"t\":188.299,\"k\":\"f\"},{\"t\":190.495,\"k\":\"j\"},{\"t\":190.672,\"k\":\"j\"},{\"t\":190.826,\"k\":\"j\"},{\"t\":190.98,\"k\":\"j\",\"h\":{\"j\":191.55388691798402}},{\"t\":191.607,\"k\":\"j\",\"h\":{\"j\":192.3911270972748}},{\"t\":192.802,\"k\":\"f\"},{\"t\":193.455,\"k\":\"k\",\"h\":{\"k\":193.85534693133545}},{\"t\":193.871,\"k\":\"d\",\"h\":{\"d\":194.30681811253356}},{\"t\":194.27,\"k\":\"k\",\"h\":{\"k\":194.9047339923706}},{\"t\":194.845,\"k\":\"d\"},{\"t\":195.007,\"k\":\"k\",\"h\":{\"k\":195.386292}},{\"t\":195.309,\"k\":\"d\"},{\"t\":195.52,\"k\":\"k\"},{\"t\":195.737,\"k\":\"d\"},{\"t\":195.87,\"k\":\"j\",\"h\":{\"j\":196.353502043869}},{\"t\":196.259,\"k\":\"f\"},{\"t\":197.941,\"k\":\"d\",\"h\":{\"d\":198.63983219073486}},{\"t\":198.988,\"k\":\"d\"},{\"t\":199.272,\"k\":\"j\"},{\"t\":199.66,\"k\":\"k\"},{\"t\":200.24,\"k\":\"j\"},{\"t\":200.459,\"k\":\"k\"},{\"t\":200.642,\"k\":\"k\"},{\"t\":200.855,\"k\":\"k\"},{\"t\":201.059,\"k\":\"j\"},{\"t\":201.592,\"k\":\"f\"},{\"t\":201.785,\"k\":\"d\"},{\"t\":202.54,\"k\":\"d\"},{\"t\":202.662,\"k\":\"f\"},{\"t\":203.063,\"k\":\"j\"},{\"t\":203.24,\"k\":\"k\",\"h\":{\"k\":203.5572478703003}},{\"t\":204.612,\"k\":\"k\"},{\"t\":204.87,\"k\":\"j\"},{\"t\":205.346,\"k\":\"f\"},{\"t\":205.889,\"k\":\"d\",\"h\":{\"d\":207.96821301716614}},{\"t\":208.586,\"k\":\"k\"},{\"t\":208.911,\"k\":\"j\",\"h\":{\"j\":210.30360202288819}},{\"t\":210.669,\"k\":\"f\"},{\"t\":211.822,\"k\":\"d\",\"h\":{\"d\":212.47827597520447}},{\"t\":213.687,\"k\":\"d\"},{\"t\":213.882,\"k\":\"f\"},{\"t\":214.142,\"k\":\"f\"},{\"t\":215.102,\"k\":\"j\"},{\"t\":215.34,\"k\":\"j\"},{\"t\":215.545,\"k\":\"k\"},{\"t\":215.773,\"k\":\"k\"},{\"t\":216.821,\"k\":\"k\"},{\"t\":216.954,\"k\":\"j\"},{\"t\":217.352,\"k\":\"f\"},{\"t\":217.456,\"k\":\"d\"},{\"t\":217.787,\"k\":\"d\",\"h\":{\"d\":218.75808881307984}},{\"t\":218.737,\"k\":\"f\"},{\"t\":219.178,\"k\":\"j\"},{\"t\":219.319,\"k\":\"k\"},{\"t\":219.82,\"k\":\"kd\",\"h\":{\"k\":220.5681130267029,\"d\":220.64469489700318}}]}"},
    {"9e2buqBpSBU", 224.82, 349, "{\"version\":1,\"title\":\"\",\"startAt\":null,\"endAt\":null,\"keys\":4,\"difficulty\":1,\"length\":224.82,\"noteCount\":349,\"visualizerName\":\"\",\"clonedFrom\":\"\",\"mappings\":[{\"t\":9.286,\"k\":\"d\"},{\"t\":12.425,\"k\":\"f\"},{\"t\":15.333,\"k\":\"j\"},{\"t\":17.267,\"k\":\"k\"},{\"t\":18.957,\"k\":\"f\"},{\"t\":19.785,\"k\":\"f\"},{\"t\":25.614,\"k\":\"d\"},{\"t\":28.868,\"k\":\"j\"},{\"t\":32.015,\"k\":\"d\"},{\"t\":32.205,\"k\":\"k\"},{\"t\":33.772,\"k\":\"d\",\"h\":{\"d\":34.73636401335144}},{\"t\":36.69,\"k\":\"k\",\"h\":{\"k\":38.032124908447265}},{\"t\":39.113,\"k\":\"f\",\"h\":{\"f\":40.41450008392334}},{\"t\":42.247,\"k\":\"j\",\"h\":{\"j\":43.47073504196167}},{\"t\":44.251,\"k\":\"d\",\"h\":{\"d\":45.48130982643127}},{\"t\":51.135,\"k\":\"k\",\"h\":{\"k\":52.39404503433227}},{\"t\":51.197,\"k\":\"d\",\"h\":{\"d\":52.44504491416931}},{\"t\":53.265,\"k\":\"k\",\"h\":{\"k\":53.59533594087219}},{\"t\":53.732,\"k\":\"k\",\"h\":{\"k\":54.95999795422363}},{\"t\":55.087,\"k\":\"k\",\"h\":{\"k\":57.646980091552734}},{\"t\":60.27,\"k\":\"d\"},{\"t\":60.564,\"k\":\"k\"},{\"t\":60.901,\"k\":\"k\"},{\"t\":61.282,\"k\":\"k\"},{\"t\":61.396,\"k\":\"d\"},{\"t\":61.603,\"k\":\"k\"},{\"t\":61.865,\"k\":\"d\"},{\"t\":62.13,\"k\":\"k\"},{\"t\":62.507,\"k\":\"d\"},{\"t\":62.74,\"k\":\"k\"},{\"t\":62.998,\"k\":\"d\"},{\"t\":63.189,\"k\":\"k\"},{\"t\":63.793,\"k\":\"d\"},{\"t\":63.964,\"k\":\"k\"},{\"t\":64.635,\"k\":\"j\"},{\"t\":65.298,\"k\":\"f\"},{\"t\":65.488,\"k\":\"j\"},{\"t\":65.733,\"k\":\"f\"},{\"t\":67.365,\"k\":\"j\"},{\"t\":67.49,\"k\":\"f\"},{\"t\":67.687,\"k\":\"j\"},{\"t\":69.342,\"k\":\"d\"},{\"t\":69.485,\"k\":\"k\"},{\"t\":70.484,\"k\":\"j\"},{\"t\":71.001,\"k\":\"d\"},{\"t\":72.117,\"k\":\"f\"},{\"t\":72.743,\"k\":\"d\"},{\"t\":73.337,\"k\":\"d\"},{\"t\":73.629,\"k\":\"d\"},{\"t\":73.865,\"k\":\"d\"},{\"t\":74.17,\"k\":\"d\",\"h\":{\"d\":75.59835706294251}},{\"t\":76.168,\"k\":\"j\",\"h\":{\"j\":79.56983505149842}},{\"t\":77.869,\"k\":\"d\",\"h\":{\"d\":79.56083498855591}},{\"t\":80.876,\"k\":\"d\"},{\"t\":81.51,\"k\":\"k\"},{\"t\":82.217,\"k\":\"j\"},{\"t\":83.604,\"k\":\"d\"},{\"t\":85.121,\"k\":\"d\"},{\"t\":85.419,\"k\":\"f\"},{\"t\":86.509,\"k\":\"k\"},{\"t\":87.053,\"k\":\"k\"},{\"t\":87.412,\"k\":\"k\"},{\"t\":87.606,\"k\":\"k\"},{\"t\":87.832,\"k\":\"k\"},{\"t\":88.045,\"k\":\"k\"},{\"t\":88.296,\"k\":\"k\"},{\"t\":89.762,\"k\":\"f\"},{\"t\":90.147,\"k\":\"d\"},{\"t\":92,\"k\":\"k\"},{\"t\":92.449,\"k\":\"j\"},{\"t\":93.086,\"k\":\"k\"},{\"t\":93.347,\"k\":\"k\"},{\"t\":93.748,\"k\":\"j\"},{\"t\":93.936,\"k\":\"j\"},{\"t\":94.229,\"k\":\"j\"},{\"t\":94.482,\"k\":\"j\"},{\"t\":94.616,\"k\":\"f\"},{\"t\":94.963,\"k\":\"j\"},{\"t\":95.362,\"k\":\"f\"},{\"t\":95.911,\"k\":\"f\"},{\"t\":96.092,\"k\":\"j\"},{\"t\":96.326,\"k\":\"f\"},{\"t\":96.515,\"k\":\"j\"},{\"t\":96.729,\"k\":\"f\"},{\"t\":96.893,\"k\":\"k\"},{\"t\":97.078,\"k\":\"f\"},{\"t\":97.267,\"k\":\"k\"},{\"t\":97.446,\"k\":\"f\"},{\"t\":97.65,\"k\":\"j\"},{\"t\":97.793,\"k\":\"f\"},{\"t\":98.003,\"k\":\"j\"},{\"t\":98.213,\"k\":\"f\"},{\"t\":98.364,\"k\":\"k\"},{\"t\":98.75,\"k\":\"f\"},{\"t\":99.136,\"k\":\"j\"},{\"t\":99.686,\"k\":\"d\"},{\"t\":100.148,\"k\":\"d\"},{\"t\":100.544,\"k\":\"d\"},{\"t\":100.923,\"k\":\"d\"},{\"t\":101.361,\"k\":\"d\"},{\"t\":101.835,\"k\":\"k\",\"h\":{\"k\":103.51463488746643}},{\"t\":103.764,\"k\":\"f\",\"h\":{\"f\":104.74087892179871}},{\"t\":106.078,\"k\":\"j\",\"h\":{\"j\":108.95916378446961}},{\"t\":109.286,\"k\":\"d\",\"h\":{\"d\":110.16422187792969}},{\"t\":110.092,\"k\":\"k\",\"h\":{\"k\":111.51699904577637}},{\"t\":111.571,\"k\":\"d\"},{\"t\":111.715,\"k\":\"k\",\"h\":{\"k\":112.0663579332428}},{\"t\":112.024,\"k\":\"d\",\"h\":{\"d\":112.34210492370606}},{\"t\":112.482,\"k\":\"k\"},{\"t\":112.684,\"k\":\"d\"},{\"t\":112.902,\"k\":\"j\",\"h\":{\"j\":113.38409218119811}},{\"t\":113.393,\"k\":\"f\",\"h\":{\"f\":113.71581616593933}},{\"t\":115.025,\"k\":\"k\",\"h\":{\"k\":115.44150289700318}},{\"t\":115.428,\"k\":\"d\"},{\"t\":115.632,\"k\":\"k\",\"h\":{\"k\":116.08103807057189}},{\"t\":116.377,\"k\":\"j\"},{\"t\":116.745,\"k\":\"j\"},{\"t\":116.931,\"k\":\"j\"},{\"t\":117.096,\"k\":\"j\"},{\"t\":117.258,\"k\":\"j\"},{\"t\":117.414,\"k\":\"j\"},{\"t\":117.745,\"k\":\"j\",\"h\":{\"j\":119.7414520553131}},{\"t\":119.995,\"k\":\"d\",\"h\":{\"d\":120.43039704768371}},{\"t\":120.364,\"k\":\"f\",\"h\":{\"f\":121.06434917929077}},{\"t\":122.95,\"k\":\"d\",\"h\":{\"d\":123.49254704768371}},{\"t\":123.246,\"k\":\"k\",\"h\":{\"k\":124.24471597138977}},{\"t\":124.405,\"k\":\"d\"},{\"t\":124.903,\"k\":\"d\"},{\"t\":125.485,\"k\":\"kf\",\"h\":{\"k\":125.96284880545043}},{\"t\":125.844,\"k\":\"f\"},{\"t\":126.079,\"k\":\"j\",\"h\":{\"j\":126.44314616403199}},{\"t\":126.312,\"k\":\"d\"},{\"t\":126.579,\"k\":\"k\"},{\"t\":126.761,\"k\":\"f\"},{\"t\":126.961,\"k\":\"j\"},{\"t\":127.194,\"k\":\"d\"},{\"t\":127.575,\"k\":\"d\"},{\"t\":128.009,\"k\":\"j\",\"h\":{\"j\":128.324096}},{\"t\":128.195,\"k\":\"f\",\"h\":{\"f\":128.52977705722046}},{\"t\":128.509,\"k\":\"j\"},{\"t\":128.783,\"k\":\"fk\"},{\"t\":129.045,\"k\":\"k\"},{\"t\":129.286,\"k\":\"d\",\"h\":{\"d\":129.63016516403198}},{\"t\":129.531,\"k\":\"k\"},{\"t\":129.744,\"k\":\"j\"},{\"t\":129.953,\"k\":\"d\"},{\"t\":130.13,\"k\":\"k\"},{\"t\":130.5,\"k\":\"kf\",\"h\":{\"f\":130.8910600858307}},{\"t\":130.763,\"k\":\"j\",\"h\":{\"j\":131.28472186839295}},{\"t\":131.447,\"k\":\"j\",\"h\":{\"j\":133.03359397329712}},{\"t\":133.297,\"k\":\"k\",\"h\":{\"k\":134.19916689891053}},{\"t\":134.121,\"k\":\"d\",\"h\":{\"d\":134.87569801335144}},{\"t\":134.992,\"k\":\"f\",\"h\":{\"f\":135.53196601335145}},{\"t\":135.55,\"k\":\"j\"},{\"t\":136.027,\"k\":\"j\"},{\"t\":136.484,\"k\":\"k\",\"h\":{\"k\":136.84375505340577}},{\"t\":137.061,\"k\":\"f\",\"h\":{\"f\":137.73667000953674}},{\"t\":138.375,\"k\":\"d\",\"h\":{\"d\":138.79716491607667}},{\"t\":138.732,\"k\":\"k\",\"h\":{\"k\":139.42555500572203}},{\"t\":139.231,\"k\":\"f\",\"h\":{\"f\":139.9238079408722}},{\"t\":139.712,\"k\":\"j\",\"h\":{\"j\":140.50523589318848}},{\"t\":141.71,\"k\":\"f\",\"h\":{\"f\":142.10464093515014}},{\"t\":141.994,\"k\":\"k\"},{\"t\":142.354,\"k\":\"dk\",\"h\":{\"k\":142.83133000190736}},{\"t\":142.933,\"k\":\"d\",\"h\":{\"d\":143.85835802098083}},{\"t\":143.811,\"k\":\"k\",\"h\":{\"k\":144.68766395994567}},{\"t\":143.945,\"k\":\"f\"},{\"t\":145.14,\"k\":\"j\",\"h\":{\"j\":145.58430395803833}},{\"t\":145.622,\"k\":\"f\"},{\"t\":145.808,\"k\":\"k\",\"h\":{\"k\":146.20557487220765}},{\"t\":146.09,\"k\":\"f\"},{\"t\":146.71,\"k\":\"d\"},{\"t\":147.091,\"k\":\"d\"},{\"t\":148.499,\"k\":\"k\"},{\"t\":148.744,\"k\":\"k\"},{\"t\":148.949,\"k\":\"k\"},{\"t\":149.149,\"k\":\"k\"},{\"t\":149.349,\"k\":\"k\"},{\"t\":149.558,\"k\":\"k\"},{\"t\":149.75,\"k\":\"k\"},{\"t\":149.944,\"k\":\"k\"},{\"t\":150.161,\"k\":\"k\"},{\"t\":150.596,\"k\":\"j\"},{\"t\":151.144,\"k\":\"f\",\"h\":{\"f\":151.8226101449585}},{\"t\":151.941,\"k\":\"d\"},{\"t\":152.341,\"k\":\"d\",\"h\":{\"d\":152.71926001716614}},{\"t\":152.686,\"k\":\"k\",\"h\":{\"k\":152.9948800076294}},{\"t\":152.89,\"k\":\"d\"},{\"t\":153.101,\"k\":\"k\"},{\"t\":153.275,\"k\":\"d\"},{\"t\":153.424,\"k\":\"k\"},{\"t\":153.611,\"k\":\"dk\"},{\"t\":153.861,\"k\":\"kd\"},{\"t\":154.091,\"k\":\"k\"},{\"t\":154.193,\"k\":\"d\"},{\"t\":154.339,\"k\":\"k\"},{\"t\":154.516,\"k\":\"k\"},{\"t\":154.574,\"k\":\"d\"},{\"t\":154.726,\"k\":\"k\"},{\"t\":154.897,\"k\":\"d\"},{\"t\":154.949,\"k\":\"k\"},{\"t\":155.128,\"k\":\"k\"},{\"t\":155.246,\"k\":\"d\",\"h\":{\"d\":157.0774719847412}},{\"t\":155.356,\"k\":\"k\",\"h\":{\"k\":157.0834717882843}},{\"t\":158.095,\"k\":\"kd\",\"h\":{\"k\":158.92853892179872,\"d\":158.93753898474122}},{\"t\":159.273,\"k\":\"kd\"},{\"t\":159.444,\"k\":\"k\"},{\"t\":159.5,\"k\":\"d\"},{\"t\":159.643,\"k\":\"k\"},{\"t\":159.743,\"k\":\"d\"},{\"t\":159.842,\"k\":\"k\"},{\"t\":159.975,\"k\":\"d\"},{\"t\":160.026,\"k\":\"k\"},{\"t\":160.211,\"k\":\"dk\"},{\"t\":160.443,\"k\":\"kd\"},{\"t\":160.66,\"k\":\"k\"},{\"t\":160.719,\"k\":\"d\"},{\"t\":160.894,\"k\":\"k\"},{\"t\":160.98,\"k\":\"d\"},{\"t\":161.112,\"k\":\"k\"},{\"t\":161.21,\"k\":\"d\"},{\"t\":161.327,\"k\":\"k\"},{\"t\":161.44,\"k\":\"d\"},{\"t\":161.519,\"k\":\"k\"},{\"t\":161.705,\"k\":\"dk\"},{\"t\":161.909,\"k\":\"k\"},{\"t\":161.975,\"k\":\"d\"},{\"t\":162.196,\"k\":\"j\"},{\"t\":162.325,\"k\":\"f\"},{\"t\":162.499,\"k\":\"j\"},{\"t\":162.699,\"k\":\"fj\"},{\"t\":162.949,\"k\":\"j\"},{\"t\":163.147,\"k\":\"j\"},{\"t\":163.339,\"k\":\"j\"},{\"t\":163.515,\"k\":\"j\"},{\"t\":163.705,\"k\":\"j\"},{\"t\":163.922,\"k\":\"j\"},{\"t\":164.135,\"k\":\"j\"},{\"t\":164.36,\"k\":\"j\"},{\"t\":164.56,\"k\":\"j\"},{\"t\":164.792,\"k\":\"fj\"},{\"t\":165.039,\"k\":\"f\"},{\"t\":165.108,\"k\":\"j\"},{\"t\":165.292,\"k\":\"fj\"},{\"t\":165.489,\"k\":\"fj\"},{\"t\":168.48,\"k\":\"jd\"},{\"t\":168.661,\"k\":\"j\"},{\"t\":168.714,\"k\":\"d\"},{\"t\":168.855,\"k\":\"j\"},{\"t\":168.924,\"k\":\"d\"},{\"t\":169.05,\"k\":\"j\"},{\"t\":169.166,\"k\":\"d\"},{\"t\":169.258,\"k\":\"j\"},{\"t\":169.405,\"k\":\"d\"},{\"t\":169.479,\"k\":\"j\"},{\"t\":169.656,\"k\":\"dj\"},{\"t\":169.9,\"k\":\"jd\"},{\"t\":170.108,\"k\":\"j\"},{\"t\":170.176,\"k\":\"d\"},{\"t\":170.338,\"k\":\"j\"},{\"t\":170.426,\"k\":\"d\"},{\"t\":170.555,\"k\":\"j\"},{\"t\":170.725,\"k\":\"d\"},{\"t\":171.021,\"k\":\"j\"},{\"t\":171.276,\"k\":\"d\"},{\"t\":171.874,\"k\":\"f\"},{\"t\":173.398,\"k\":\"f\"},{\"t\":173.845,\"k\":\"f\"},{\"t\":174.21,\"k\":\"f\"},{\"t\":174.472,\"k\":\"k\"},{\"t\":175.306,\"k\":\"k\"},{\"t\":175.505,\"k\":\"k\"},{\"t\":176.992,\"k\":\"d\"},{\"t\":179.054,\"k\":\"f\"},{\"t\":180.892,\"k\":\"j\"},{\"t\":182.122,\"k\":\"k\"},{\"t\":182.711,\"k\":\"k\"},{\"t\":183.217,\"k\":\"k\"},{\"t\":184.007,\"k\":\"k\"},{\"t\":184.255,\"k\":\"k\"},{\"t\":184.52,\"k\":\"k\"},{\"t\":185.555,\"k\":\"k\"},{\"t\":185.728,\"k\":\"k\"},{\"t\":185.904,\"k\":\"k\"},{\"t\":186.061,\"k\":\"k\"},{\"t\":186.294,\"k\":\"k\"},{\"t\":186.479,\"k\":\"k\"},{\"t\":186.871,\"k\":\"k\"},{\"t\":187.041,\"k\":\"k\"},{\"t\":187.271,\"k\":\"k\"},{\"t\":187.486,\"k\":\"k\"},{\"t\":187.691,\"k\":\"k\"},{\"t\":187.906,\"k\":\"k\"},{\"t\":188.299,\"k\":\"f\"},{\"t\":190.495,\"k\":\"j\"},{\"t\":190.672,\"k\":\"j\"},{\"t\":190.826,\"k\":\"j\"},{\"t\":190.98,\"k\":\"j\",\"h\":{\"j\":191.55388691798402}},{\"t\":191.607,\"k\":\"j\",\"h\":{\"j\":192.3911270972748}},{\"t\":192.802,\"k\":\"f\"},{\"t\":193.455,\"k\":\"k\",\"h\":{\"k\":193.85534693133545}},{\"t\":193.871,\"k\":\"d\",\"h\":{\"d\":194.30681811253356}},{\"t\":194.27,\"k\":\"k\",\"h\":{\"k\":194.9047339923706}},{\"t\":194.845,\"k\":\"d\"},{\"t\":195.007,\"k\":\"k\",\"h\":{\"k\":195.386292}},{\"t\":195.309,\"k\":\"d\"},{\"t\":195.52,\"k\":\"k\"},{\"t\":195.737,\"k\":\"d\"},{\"t\":195.87,\"k\":\"j\",\"h\":{\"j\":196.353502043869}},{\"t\":196.259,\"k\":\"f\"},{\"t\":197.941,\"k\":\"d\",\"h\":{\"d\":198.63983219073486}},{\"t\":198.988,\"k\":\"d\"},{\"t\":199.272,\"k\":\"j\"},{\"t\":199.66,\"k\":\"k\"},{\"t\":200.24,\"k\":\"j\"},{\"t\":200.459,\"k\":\"k\"},{\"t\":200.642,\"k\":\"k\"},{\"t\":200.855,\"k\":\"k\"},{\"t\":201.059,\"k\":\"j\"},{\"t\":201.592,\"k\":\"f\"},{\"t\":201.785,\"k\":\"d\"},{\"t\":202.54,\"k\":\"d\"},{\"t\":202.662,\"k\":\"f\"},{\"t\":203.063,\"k\":\"j\"},{\"t\":203.24,\"k\":\"k\",\"h\":{\"k\":203.5572478703003}},{\"t\":204.612,\"k\":\"k\"},{\"t\":204.87,\"k\":\"j\"},{\"t\":205.346,\"k\":\"f\"},{\"t\":205.889,\"k\":\"d\",\"h\":{\"d\":207.96821301716614}},{\"t\":208.586,\"k\":\"k\"},{\"t\":208.911,\"k\":\"j\",\"h\":{\"j\":210.30360202288819}},{\"t\":210.669,\"k\":\"f\"},{\"t\":211.822,\"k\":\"d\",\"h\":{\"d\":212.47827597520447}},{\"t\":213.687,\"k\":\"d\"},{\"t\":213.882,\"k\":\"f\"},{\"t\":214.142,\"k\":\"f\"},{\"t\":215.102,\"k\":\"j\"},{\"t\":215.34,\"k\":\"j\"},{\"t\":215.545,\"k\":\"k\"},{\"t\":215.773,\"k\":\"k\"},{\"t\":216.821,\"k\":\"k\"},{\"t\":216.954,\"k\":\"j\"},{\"t\":217.352,\"k\":\"f\"},{\"t\":217.456,\"k\":\"d\"},{\"t\":217.787,\"k\":\"d\",\"h\":{\"d\":218.75808881307984}},{\"t\":218.737,\"k\":\"f\"},{\"t\":219.178,\"k\":\"j\"},{\"t\":219.319,\"k\":\"k\"},{\"t\":219.82,\"k\":\"kd\",\"h\":{\"k\":220.5681130267029,\"d\":220.64469489700318}}]}"},
    {"dQw4w9WgXcQ", 202.061, 566, "{\"version\":1,\"title\":\"gay\",\"startAt\":null,\"endAt\":null,\"keys\":4,\"difficulty\":4,\"length\":212.061,\"noteCount\":566,\"visualizerName\":\"\",\"clonedFrom\":\"\",\"mappings\":[{\"t\":1.239,\"k\":\"d\"},{\"t\":2.19,\"k\":\"j\"},{\"t\":2.965,\"k\":\"k\"},{\"t\":3.361,\"k\":\"f\"},{\"t\":4.171,\"k\":\"d\"},{\"t\":4.952,\"k\":\"f\"},{\"t\":5.122,\"k\":\"j\"},{\"t\":5.193,\"k\":\"k\"},{\"t\":5.782,\"k\":\"f\"},{\"t\":6.387,\"k\":\"d\"},{\"t\":7.176,\"k\":\"j\"},{\"t\":7.597,\"k\":\"k\"},{\"t\":8.073,\"k\":\"f\"},{\"t\":8.774,\"k\":\"d\"},{\"t\":9.208,\"k\":\"j\"},{\"t\":9.838,\"k\":\"k\"},{\"t\":10.535,\"k\":\"f\"},{\"t\":11.257,\"k\":\"d\"},{\"t\":11.886,\"k\":\"d\"},{\"t\":12.561,\"k\":\"f\"},{\"t\":13.227,\"k\":\"j\"},{\"t\":13.382,\"k\":\"k\"},{\"t\":13.635,\"k\":\"d\"},{\"t\":13.809,\"k\":\"f\"},{\"t\":13.976,\"k\":\"j\"},{\"t\":14.153,\"k\":\"d\"},{\"t\":14.34,\"k\":\"k\"},{\"t\":14.386,\"k\":\"f\"},{\"t\":14.756,\"k\":\"d\"},{\"t\":15.527,\"k\":\"j\"},{\"t\":15.992,\"k\":\"k\"},{\"t\":16.582,\"k\":\"d\"},{\"t\":18.659,\"k\":\"d\"},{\"t\":18.953,\"k\":\"f\"},{\"t\":19.171,\"k\":\"j\"},{\"t\":19.349,\"k\":\"k\"},{\"t\":19.641,\"k\":\"d\"},{\"t\":19.95,\"k\":\"d\"},{\"t\":20.289,\"k\":\"j\"},{\"t\":22.666,\"k\":\"d\"},{\"t\":22.991,\"k\":\"j\"},{\"t\":23.244,\"k\":\"k\"},{\"t\":23.547,\"k\":\"f\"},{\"t\":24.299,\"k\":\"d\"},{\"t\":24.629,\"k\":\"f\"},{\"t\":25.124,\"k\":\"k\"},{\"t\":25.458,\"k\":\"j\"},{\"t\":26.927,\"k\":\"d\"},{\"t\":27.253,\"k\":\"j\"},{\"t\":27.522,\"k\":\"f\"},{\"t\":27.647,\"k\":\"k\"},{\"t\":27.924,\"k\":\"d\"},{\"t\":28.122,\"k\":\"j\"},{\"t\":28.37,\"k\":\"f\"},{\"t\":28.537,\"k\":\"k\"},{\"t\":29.081,\"k\":\"d\"},{\"t\":29.379,\"k\":\"d\"},{\"t\":29.627,\"k\":\"d\"},{\"t\":31.088,\"k\":\"d\"},{\"t\":31.339,\"k\":\"k\"},{\"t\":31.554,\"k\":\"f\"},{\"t\":31.737,\"k\":\"k\"},{\"t\":31.939,\"k\":\"d\"},{\"t\":32.188,\"k\":\"j\"},{\"t\":32.404,\"k\":\"d\"},{\"t\":33.089,\"k\":\"k\"},{\"t\":33.339,\"k\":\"d\"},{\"t\":33.595,\"k\":\"k\"},{\"t\":33.765,\"k\":\"d\"},{\"t\":34.125,\"k\":\"j\",\"h\":{\"j\":34.91389902670288}},{\"t\":35.047,\"k\":\"d\",\"h\":{\"d\":35.444477912261966}},{\"t\":35.927,\"k\":\"d\",\"h\":{\"d\":36.32977908583069}},{\"t\":36.53,\"k\":\"j\"},{\"t\":36.741,\"k\":\"j\"},{\"t\":37.126,\"k\":\"f\"},{\"t\":37.275,\"k\":\"k\"},{\"t\":37.725,\"k\":\"k\"},{\"t\":38.024,\"k\":\"k\"},{\"t\":38.325,\"k\":\"j\"},{\"t\":38.777,\"k\":\"d\"},{\"t\":40.27,\"k\":\"d\"},{\"t\":40.603,\"k\":\"d\"},{\"t\":40.847,\"k\":\"d\"},{\"t\":41.116,\"k\":\"d\"},{\"t\":41.625,\"k\":\"d\"},{\"t\":41.887,\"k\":\"d\"},{\"t\":42.097,\"k\":\"d\"},{\"t\":42.918,\"k\":\"d\"},{\"t\":43.226,\"k\":\"d\"},{\"t\":43.384,\"k\":\"d\"},{\"t\":43.55,\"k\":\"d\"},{\"t\":43.931,\"k\":\"f\"},{\"t\":44.28,\"k\":\"j\"},{\"t\":45.018,\"k\":\"k\"},{\"t\":45.21,\"k\":\"k\"},{\"t\":45.46,\"k\":\"k\"},{\"t\":45.611,\"k\":\"j\"},{\"t\":46.059,\"k\":\"f\"},{\"t\":46.423,\"k\":\"d\"},{\"t\":47.175,\"k\":\"d\"},{\"t\":47.39,\"k\":\"d\"},{\"t\":47.549,\"k\":\"d\"},{\"t\":47.76,\"k\":\"j\"},{\"t\":48.249,\"k\":\"f\"},{\"t\":48.52,\"k\":\"k\"},{\"t\":48.766,\"k\":\"d\"},{\"t\":49.118,\"k\":\"k\"},{\"t\":49.72,\"k\":\"d\"},{\"t\":49.955,\"k\":\"d\",\"h\":{\"d\":50.390404032424925}},{\"t\":50.462,\"k\":\"d\",\"h\":{\"d\":51.0273240705719}},{\"t\":51.336,\"k\":\"f\"},{\"t\":51.557,\"k\":\"j\"},{\"t\":51.685,\"k\":\"f\"},{\"t\":51.817,\"k\":\"j\"},{\"t\":52.062,\"k\":\"k\"},{\"t\":52.438,\"k\":\"d\"},{\"t\":52.816,\"k\":\"d\"},{\"t\":53.566,\"k\":\"f\"},{\"t\":53.863,\"k\":\"f\"},{\"t\":54.115,\"k\":\"j\"},{\"t\":54.582,\"k\":\"j\"},{\"t\":54.862,\"k\":\"j\"},{\"t\":55.063,\"k\":\"j\",\"h\":{\"j\":55.413525175476074}},{\"t\":55.66,\"k\":\"j\"},{\"t\":55.869,\"k\":\"j\"},{\"t\":56.075,\"k\":\"j\"},{\"t\":56.712,\"k\":\"j\"},{\"t\":57.028,\"k\":\"f\"},{\"t\":57.52,\"k\":\"d\"},{\"t\":57.716,\"k\":\"k\"},{\"t\":58.448,\"k\":\"d\"},{\"t\":58.844,\"k\":\"j\"},{\"t\":59.388,\"k\":\"f\"},{\"t\":59.514,\"k\":\"j\"},{\"t\":59.885,\"k\":\"f\"},{\"t\":59.994,\"k\":\"j\"},{\"t\":60.129,\"k\":\"f\"},{\"t\":60.248,\"k\":\"j\"},{\"t\":60.617,\"k\":\"k\"},{\"t\":60.922,\"k\":\"d\"},{\"t\":61.137,\"k\":\"j\"},{\"t\":61.382,\"k\":\"d\"},{\"t\":61.557,\"k\":\"k\"},{\"t\":61.786,\"k\":\"d\"},{\"t\":62.823,\"k\":\"j\"},{\"t\":63.079,\"k\":\"f\"},{\"t\":63.241,\"k\":\"k\"},{\"t\":63.452,\"k\":\"d\"},{\"t\":63.537,\"k\":\"k\"},{\"t\":63.663,\"k\":\"d\"},{\"t\":64.961,\"k\":\"j\"},{\"t\":65.207,\"k\":\"f\"},{\"t\":65.374,\"k\":\"k\"},{\"t\":65.634,\"k\":\"d\"},{\"t\":65.855,\"k\":\"j\"},{\"t\":66.063,\"k\":\"f\"},{\"t\":66.19,\"k\":\"k\"},{\"t\":66.967,\"k\":\"k\"},{\"t\":67.229,\"k\":\"d\"},{\"t\":67.442,\"k\":\"j\"},{\"t\":67.622,\"k\":\"f\"},{\"t\":68.148,\"k\":\"j\"},{\"t\":68.387,\"k\":\"j\"},{\"t\":68.643,\"k\":\"j\"},{\"t\":69.248,\"k\":\"j\"},{\"t\":69.496,\"k\":\"d\"},{\"t\":69.719,\"k\":\"k\"},{\"t\":69.984,\"k\":\"f\"},{\"t\":70.14,\"k\":\"j\"},{\"t\":70.364,\"k\":\"d\"},{\"t\":70.53,\"k\":\"k\"},{\"t\":70.787,\"k\":\"f\"},{\"t\":71.239,\"k\":\"j\"},{\"t\":71.465,\"k\":\"d\"},{\"t\":71.666,\"k\":\"k\"},{\"t\":71.92,\"k\":\"f\"},{\"t\":72.039,\"k\":\"j\"},{\"t\":73.315,\"k\":\"j\"},{\"t\":73.598,\"k\":\"d\"},{\"t\":73.858,\"k\":\"k\"},{\"t\":74.132,\"k\":\"f\"},{\"t\":74.336,\"k\":\"j\"},{\"t\":74.542,\"k\":\"d\"},{\"t\":74.79,\"k\":\"k\",\"h\":{\"k\":75.29385021362305}},{\"t\":75.669,\"k\":\"d\"},{\"t\":75.84,\"k\":\"j\"},{\"t\":76.044,\"k\":\"f\"},{\"t\":76.173,\"k\":\"k\"},{\"t\":76.544,\"k\":\"d\"},{\"t\":77.325,\"k\":\"j\",\"h\":{\"j\":78.64017700762939}},{\"t\":78.735,\"k\":\"f\"},{\"t\":78.896,\"k\":\"k\"},{\"t\":79.067,\"k\":\"d\"},{\"t\":79.284,\"k\":\"j\"},{\"t\":79.823,\"k\":\"f\"},{\"t\":80.023,\"k\":\"k\"},{\"t\":80.185,\"k\":\"d\"},{\"t\":80.364,\"k\":\"j\"},{\"t\":80.533,\"k\":\"f\"},{\"t\":80.701,\"k\":\"k\"},{\"t\":81.182,\"k\":\"j\"},{\"t\":82.68,\"k\":\"d\"},{\"t\":82.981,\"k\":\"k\"},{\"t\":83.19,\"k\":\"f\"},{\"t\":83.377,\"k\":\"j\"},{\"t\":83.538,\"k\":\"d\"},{\"t\":84.009,\"k\":\"k\"},{\"t\":84.26,\"k\":\"d\"},{\"t\":84.459,\"k\":\"j\"},{\"t\":84.628,\"k\":\"f\",\"h\":{\"f\":84.97351602479553}},{\"t\":85.406,\"k\":\"k\"},{\"t\":85.571,\"k\":\"d\"},{\"t\":85.699,\"k\":\"j\"},{\"t\":85.837,\"k\":\"f\"},{\"t\":86.002,\"k\":\"j\",\"h\":{\"j\":86.41346001335144}},{\"t\":86.389,\"k\":\"f\"},{\"t\":86.69,\"k\":\"j\",\"h\":{\"j\":87.28872895803833}},{\"t\":87.415,\"k\":\"d\"},{\"t\":87.493,\"k\":\"k\"},{\"t\":87.622,\"k\":\"d\"},{\"t\":87.711,\"k\":\"k\"},{\"t\":87.887,\"k\":\"d\"},{\"t\":88.288,\"k\":\"j\"},{\"t\":88.716,\"k\":\"f\"},{\"t\":89.484,\"k\":\"k\"},{\"t\":89.682,\"k\":\"d\"},{\"t\":89.803,\"k\":\"k\"},{\"t\":89.931,\"k\":\"d\"},{\"t\":90.112,\"k\":\"j\"},{\"t\":90.63,\"k\":\"f\"},{\"t\":90.751,\"k\":\"k\"},{\"t\":91.021,\"k\":\"d\"},{\"t\":91.331,\"k\":\"j\"},{\"t\":91.985,\"k\":\"k\"},{\"t\":92.377,\"k\":\"j\"},{\"t\":92.811,\"k\":\"f\"},{\"t\":93.838,\"k\":\"d\"},{\"t\":94.01,\"k\":\"j\"},{\"t\":94.178,\"k\":\"f\"},{\"t\":94.358,\"k\":\"k\"},{\"t\":94.731,\"k\":\"d\"},{\"t\":95.103,\"k\":\"j\"},{\"t\":95.92,\"k\":\"k\"},{\"t\":96.155,\"k\":\"f\"},{\"t\":96.367,\"k\":\"j\"},{\"t\":96.849,\"k\":\"d\"},{\"t\":97.177,\"k\":\"d\",\"h\":{\"d\":97.75044901716613}},{\"t\":97.949,\"k\":\"k\"},{\"t\":98.185,\"k\":\"df\"},{\"t\":98.3,\"k\":\"j\"},{\"t\":98.44,\"k\":\"f\"},{\"t\":98.557,\"k\":\"k\"},{\"t\":99,\"k\":\"d\"},{\"t\":99.165,\"k\":\"j\"},{\"t\":99.517,\"k\":\"k\"},{\"t\":99.858,\"k\":\"f\"},{\"t\":99.951,\"k\":\"j\"},{\"t\":100.577,\"k\":\"d\"},{\"t\":100.827,\"k\":\"k\"},{\"t\":101.28,\"k\":\"j\"},{\"t\":103.341,\"k\":\"j\"},{\"t\":103.825,\"k\":\"f\"},{\"t\":104.322,\"k\":\"k\"},{\"t\":104.572,\"k\":\"f\"},{\"t\":104.682,\"k\":\"j\"},{\"t\":104.823,\"k\":\"d\"},{\"t\":104.934,\"k\":\"k\"},{\"t\":105.321,\"k\":\"f\"},{\"t\":105.696,\"k\":\"j\"},{\"t\":106.487,\"k\":\"k\"},{\"t\":106.668,\"k\":\"d\"},{\"t\":106.778,\"k\":\"j\"},{\"t\":106.946,\"k\":\"f\"},{\"t\":107.033,\"k\":\"k\"},{\"t\":107.588,\"k\":\"d\"},{\"t\":107.884,\"k\":\"j\"},{\"t\":108.22,\"k\":\"f\"},{\"t\":108.367,\"k\":\"k\"},{\"t\":108.495,\"k\":\"d\"},{\"t\":108.982,\"k\":\"j\"},{\"t\":109.18,\"k\":\"f\"},{\"t\":109.619,\"k\":\"k\"},{\"t\":110.746,\"k\":\"j\"},{\"t\":110.92,\"k\":\"d\"},{\"t\":111.045,\"k\":\"k\"},{\"t\":111.174,\"k\":\"f\"},{\"t\":111.309,\"k\":\"j\"},{\"t\":111.69,\"k\":\"d\"},{\"t\":112.058,\"k\":\"k\"},{\"t\":112.821,\"k\":\"f\"},{\"t\":112.956,\"k\":\"j\"},{\"t\":113.094,\"k\":\"d\"},{\"t\":113.256,\"k\":\"k\"},{\"t\":113.387,\"k\":\"f\"},{\"t\":113.936,\"k\":\"j\"},{\"t\":114.137,\"k\":\"d\"},{\"t\":114.542,\"k\":\"k\"},{\"t\":114.662,\"k\":\"f\"},{\"t\":114.788,\"k\":\"j\"},{\"t\":115.113,\"k\":\"d\"},{\"t\":115.287,\"k\":\"k\"},{\"t\":115.4,\"k\":\"df\"},{\"t\":115.534,\"k\":\"j\"},{\"t\":115.711,\"k\":\"f\"},{\"t\":116.134,\"k\":\"k\"},{\"t\":116.334,\"k\":\"d\"},{\"t\":116.72,\"k\":\"j\"},{\"t\":116.838,\"k\":\"f\"},{\"t\":117.439,\"k\":\"k\"},{\"t\":117.643,\"k\":\"d\"},{\"t\":118.163,\"k\":\"j\",\"h\":{\"j\":118.8764272155304}},{\"t\":119.357,\"k\":\"j\"},{\"t\":119.803,\"k\":\"f\"},{\"t\":120.343,\"k\":\"k\"},{\"t\":120.643,\"k\":\"d\"},{\"t\":121.894,\"k\":\"j\"},{\"t\":122.245,\"k\":\"k\"},{\"t\":122.62,\"k\":\"j\"},{\"t\":123.415,\"k\":\"d\"},{\"t\":123.936,\"k\":\"d\",\"h\":{\"d\":127.142065}},{\"t\":126.027,\"k\":\"j\"},{\"t\":126.415,\"k\":\"k\"},{\"t\":126.758,\"k\":\"j\"},{\"t\":127.583,\"k\":\"d\",\"h\":{\"d\":135.6020240591278}},{\"t\":128.533,\"k\":\"j\"},{\"t\":128.645,\"k\":\"k\"},{\"t\":128.784,\"k\":\"j\"},{\"t\":128.862,\"k\":\"k\"},{\"t\":129.506,\"k\":\"k\"},{\"t\":129.729,\"k\":\"j\"},{\"t\":130.32,\"k\":\"f\"},{\"t\":130.718,\"k\":\"f\"},{\"t\":131.108,\"k\":\"f\"},{\"t\":131.78,\"k\":\"j\"},{\"t\":132.556,\"k\":\"j\"},{\"t\":132.638,\"k\":\"k\"},{\"t\":132.817,\"k\":\"j\"},{\"t\":132.907,\"k\":\"k\"},{\"t\":133.024,\"k\":\"j\"},{\"t\":133.119,\"k\":\"k\"},{\"t\":133.366,\"k\":\"j\"},{\"t\":133.455,\"k\":\"k\"},{\"t\":133.583,\"k\":\"j\"},{\"t\":133.713,\"k\":\"k\"},{\"t\":133.851,\"k\":\"j\"},{\"t\":134.452,\"k\":\"f\"},{\"t\":134.92,\"k\":\"f\"},{\"t\":135.256,\"k\":\"f\"},{\"t\":136.799,\"k\":\"j\"},{\"t\":136.999,\"k\":\"d\"},{\"t\":137.211,\"k\":\"k\"},{\"t\":137.553,\"k\":\"f\"},{\"t\":137.862,\"k\":\"j\"},{\"t\":138.912,\"k\":\"d\"},{\"t\":139.275,\"k\":\"f\"},{\"t\":139.541,\"k\":\"j\"},{\"t\":139.814,\"k\":\"k\"},{\"t\":141.15,\"k\":\"j\"},{\"t\":141.39,\"k\":\"d\"},{\"t\":141.64,\"k\":\"k\"},{\"t\":141.894,\"k\":\"f\"},{\"t\":142.074,\"k\":\"j\"},{\"t\":142.234,\"k\":\"d\"},{\"t\":142.534,\"k\":\"k\"},{\"t\":143.084,\"k\":\"d\"},{\"t\":143.271,\"k\":\"j\"},{\"t\":143.476,\"k\":\"f\"},{\"t\":143.692,\"k\":\"j\"},{\"t\":144.232,\"k\":\"f\"},{\"t\":144.484,\"k\":\"j\"},{\"t\":144.742,\"k\":\"f\"},{\"t\":145.246,\"k\":\"j\"},{\"t\":145.534,\"k\":\"f\"},{\"t\":145.74,\"k\":\"k\"},{\"t\":145.99,\"k\":\"d\"},{\"t\":146.244,\"k\":\"j\"},{\"t\":146.514,\"k\":\"f\"},{\"t\":146.718,\"k\":\"k\"},{\"t\":146.886,\"k\":\"d\"},{\"t\":147.335,\"k\":\"j\"},{\"t\":147.536,\"k\":\"f\"},{\"t\":147.876,\"k\":\"k\"},{\"t\":148.017,\"k\":\"jd\"},{\"t\":148.089,\"k\":\"k\"},{\"t\":149.513,\"k\":\"j\"},{\"t\":149.796,\"k\":\"f\"},{\"t\":150.045,\"k\":\"k\"},{\"t\":150.259,\"k\":\"d\"},{\"t\":150.589,\"k\":\"j\"},{\"t\":150.738,\"k\":\"f\"},{\"t\":151.643,\"k\":\"j\"},{\"t\":151.889,\"k\":\"f\"},{\"t\":152.156,\"k\":\"k\"},{\"t\":152.737,\"k\":\"d\",\"h\":{\"d\":153.28583195613098}},{\"t\":153.485,\"k\":\"j\",\"h\":{\"j\":154.73962404959107}},{\"t\":154.783,\"k\":\"f\"},{\"t\":155.087,\"k\":\"j\"},{\"t\":155.258,\"k\":\"f\"},{\"t\":155.482,\"k\":\"k\"},{\"t\":155.734,\"k\":\"d\"},{\"t\":155.996,\"k\":\"j\"},{\"t\":156.201,\"k\":\"f\"},{\"t\":156.423,\"k\":\"k\"},{\"t\":156.589,\"k\":\"d\"},{\"t\":157.187,\"k\":\"j\"},{\"t\":158.712,\"k\":\"j\"},{\"t\":159.026,\"k\":\"f\"},{\"t\":159.226,\"k\":\"k\"},{\"t\":159.523,\"k\":\"d\"},{\"t\":160.01,\"k\":\"j\"},{\"t\":160.331,\"k\":\"f\"},{\"t\":160.555,\"k\":\"k\"},{\"t\":161.523,\"k\":\"j\"},{\"t\":161.653,\"k\":\"d\"},{\"t\":161.769,\"k\":\"k\"},{\"t\":161.951,\"k\":\"d\"},{\"t\":162.332,\"k\":\"j\",\"h\":{\"j\":162.66463482833862}},{\"t\":162.752,\"k\":\"f\",\"h\":{\"f\":163.28560300190736}},{\"t\":163.436,\"k\":\"k\"},{\"t\":163.584,\"k\":\"d\"},{\"t\":163.694,\"k\":\"j\"},{\"t\":163.887,\"k\":\"f\"},{\"t\":163.995,\"k\":\"k\"},{\"t\":164.336,\"k\":\"d\"},{\"t\":164.75,\"k\":\"j\",\"h\":{\"j\":165.0850109446869}},{\"t\":165.58,\"k\":\"k\"},{\"t\":165.736,\"k\":\"f\"},{\"t\":165.912,\"k\":\"j\"},{\"t\":166.04,\"k\":\"f\"},{\"t\":166.219,\"k\":\"k\",\"h\":{\"k\":166.54859916212465}},{\"t\":166.641,\"k\":\"d\"},{\"t\":166.847,\"k\":\"j\"},{\"t\":167.078,\"k\":\"f\"},{\"t\":167.421,\"k\":\"k\"},{\"t\":167.577,\"k\":\"d\"},{\"t\":168.074,\"k\":\"j\"},{\"t\":168.379,\"k\":\"f\"},{\"t\":168.876,\"k\":\"k\"},{\"t\":169.946,\"k\":\"j\"},{\"t\":170.115,\"k\":\"d\"},{\"t\":170.282,\"k\":\"k\"},{\"t\":170.47,\"k\":\"f\"},{\"t\":170.54,\"k\":\"j\"},{\"t\":170.913,\"k\":\"d\"},{\"t\":171.272,\"k\":\"k\"},{\"t\":172.146,\"k\":\"j\"},{\"t\":172.267,\"k\":\"f\"},{\"t\":172.394,\"k\":\"k\"},{\"t\":172.565,\"k\":\"d\"},{\"t\":172.667,\"k\":\"j\"},{\"t\":173.083,\"k\":\"f\"},{\"t\":173.376,\"k\":\"k\"},{\"t\":173.835,\"k\":\"d\"},{\"t\":174.266,\"k\":\"d\"},{\"t\":174.384,\"k\":\"j\"},{\"t\":174.564,\"k\":\"fk\"},{\"t\":174.682,\"k\":\"k\"},{\"t\":174.732,\"k\":\"d\"},{\"t\":175.218,\"k\":\"j\"},{\"t\":175.38,\"k\":\"d\"},{\"t\":175.634,\"k\":\"k\"},{\"t\":176.018,\"k\":\"f\"},{\"t\":176.09,\"k\":\"j\"},{\"t\":176.578,\"k\":\"d\"},{\"t\":176.817,\"k\":\"k\"},{\"t\":177.275,\"k\":\"j\"},{\"t\":178.657,\"k\":\"j\"},{\"t\":178.941,\"k\":\"f\"},{\"t\":179.145,\"k\":\"k\"},{\"t\":179.449,\"k\":\"d\"},{\"t\":179.739,\"k\":\"j\"},{\"t\":180.446,\"k\":\"k\"},{\"t\":180.613,\"k\":\"f\"},{\"t\":180.737,\"k\":\"j\"},{\"t\":180.864,\"k\":\"d\"},{\"t\":180.991,\"k\":\"j\"},{\"t\":181.336,\"k\":\"f\"},{\"t\":181.687,\"k\":\"k\"},{\"t\":182.311,\"k\":\"j\"},{\"t\":182.536,\"k\":\"f\"},{\"t\":182.618,\"k\":\"dk\"},{\"t\":182.816,\"k\":\"j\"},{\"t\":182.989,\"k\":\"f\"},{\"t\":183.516,\"k\":\"j\"},{\"t\":183.715,\"k\":\"f\"},{\"t\":183.873,\"k\":\"k\"},{\"t\":184.364,\"k\":\"j\"},{\"t\":184.878,\"k\":\"d\"},{\"t\":185.133,\"k\":\"j\"},{\"t\":185.381,\"k\":\"f\",\"h\":{\"f\":185.75721101335145}},{\"t\":185.805,\"k\":\"j\",\"h\":{\"j\":186.22852185313417}},{\"t\":186.78,\"k\":\"dk\"},{\"t\":187.063,\"k\":\"j\"},{\"t\":187.209,\"k\":\"f\"},{\"t\":187.322,\"k\":\"k\"},{\"t\":187.666,\"k\":\"d\"},{\"t\":188.059,\"k\":\"k\",\"h\":{\"k\":188.60862100762938}},{\"t\":188.784,\"k\":\"j\"},{\"t\":188.921,\"k\":\"f\"},{\"t\":189.057,\"k\":\"k\"},{\"t\":189.124,\"k\":\"d\"},{\"t\":189.306,\"k\":\"k\"},{\"t\":189.469,\"k\":\"d\",\"h\":{\"d\":189.95525100953674}},{\"t\":189.966,\"k\":\"j\"},{\"t\":190.304,\"k\":\"k\"},{\"t\":190.676,\"k\":\"k\",\"h\":{\"k\":191.20251720980835}},{\"t\":191.274,\"k\":\"j\"},{\"t\":191.451,\"k\":\"f\"},{\"t\":191.573,\"k\":\"j\"},{\"t\":191.751,\"k\":\"d\"},{\"t\":192.112,\"k\":\"k\"},{\"t\":192.45,\"k\":\"j\"},{\"t\":192.858,\"k\":\"d\"},{\"t\":193.597,\"k\":\"j\"},{\"t\":193.797,\"k\":\"f\"},{\"t\":194.196,\"k\":\"k\"},{\"t\":195.943,\"k\":\"j\"},{\"t\":196.445,\"k\":\"k\"},{\"t\":196.861,\"k\":\"d\"},{\"t\":197.538,\"k\":\"j\"},{\"t\":197.713,\"k\":\"f\"},{\"t\":197.796,\"k\":\"k\"},{\"t\":197.939,\"k\":\"d\"},{\"t\":198.099,\"k\":\"j\"},{\"t\":198.441,\"k\":\"f\"},{\"t\":198.752,\"k\":\"k\"},{\"t\":199.586,\"k\":\"j\"},{\"t\":199.738,\"k\":\"d\"},{\"t\":199.873,\"k\":\"k\"},{\"t\":199.987,\"k\":\"d\"},{\"t\":200.121,\"k\":\"f\"},{\"t\":200.518,\"k\":\"k\"},{\"t\":200.867,\"k\":\"d\"},{\"t\":201.202,\"k\":\"j\"},{\"t\":201.401,\"k\":\"f\"},{\"t\":201.799,\"k\":\"k\"},{\"t\":201.966,\"k\":\"d\"},{\"t\":202.15,\"k\":\"j\"},{\"t\":202.599,\"k\":\"f\"},{\"t\":203.58,\"k\":\"k\"},{\"t\":203.78,\"k\":\"d\"},{\"t\":203.914,\"k\":\"j\"},{\"t\":204.027,\"k\":\"f\"},{\"t\":204.112,\"k\":\"k\"},{\"t\":204.487,\"k\":\"d\"},{\"t\":205.014,\"k\":\"j\"},{\"t\":205.711,\"k\":\"f\"},{\"t\":205.872,\"k\":\"j\"},{\"t\":206.107,\"k\":\"f\"},{\"t\":206.22,\"k\":\"k\"},{\"t\":206.356,\"k\":\"d\"},{\"t\":206.758,\"k\":\"j\"},{\"t\":207.008,\"k\":\"k\"},{\"t\":207.355,\"k\":\"k\"},{\"t\":207.479,\"k\":\"k\"},{\"t\":207.804,\"k\":\"j\"},{\"t\":207.971,\"k\":\"f\"},{\"t\":208.059,\"k\":\"dk\"},{\"t\":208.316,\"k\":\"j\"},{\"t\":208.805,\"k\":\"f\"},{\"t\":209.053,\"k\":\"f\"},{\"t\":209.395,\"k\":\"f\"},{\"t\":209.585,\"k\":\"f\"},{\"t\":210.085,\"k\":\"k\"},{\"t\":210.32,\"k\":\"d\"},{\"t\":210.529,\"k\":\"j\"}]}"}};

float volume = 0.9; // Set initial volume
// char *songName = "youbelongwithmeeasy";
bool playing = false;
float songLength;
char *gameMapping;
piano_note_t *notes;
int totalNotes;
long startTime;
long currentTime;
float secondsElapsed;

#line 119 "/Users/gabriel/Documents/Arduino/game/game.ino"
void actionKeyIncreaseVolume(bool active, int pin, void *ptr);
#line 133 "/Users/gabriel/Documents/Arduino/game/game.ino"
void actionKeyDecreaseVolume(bool active, int pin, void *ptr);
#line 147 "/Users/gabriel/Documents/Arduino/game/game.ino"
void setupActions();
#line 156 "/Users/gabriel/Documents/Arduino/game/game.ino"
void setupTiles();
#line 270 "/Users/gabriel/Documents/Arduino/game/game.ino"
void getMappings(const char *mapping);
#line 294 "/Users/gabriel/Documents/Arduino/game/game.ino"
int addNotesFromJson(JsonObject obj, int i);
#line 435 "/Users/gabriel/Documents/Arduino/game/game.ino"
void displayNotes();
#line 514 "/Users/gabriel/Documents/Arduino/game/game.ino"
void setup();
#line 558 "/Users/gabriel/Documents/Arduino/game/game.ino"
void loop();
#line 593 "/Users/gabriel/Documents/Arduino/game/game.ino"
void setupLEDs(void *params);
#line 606 "/Users/gabriel/Documents/Arduino/game/game.ino"
void runLEDs();
#line 636 "/Users/gabriel/Documents/Arduino/game/game.ino"
void setupAudio(void *params);
#line 647 "/Users/gabriel/Documents/Arduino/game/game.ino"
void audioPlayer();
#line 658 "/Users/gabriel/Documents/Arduino/game/game.ino"
void printNote(piano_note_t note);
#line 697 "/Users/gabriel/Documents/Arduino/game/game.ino"
void displayColumns();
#line 722 "/Users/gabriel/Documents/Arduino/game/game.ino"
uint32_t lighter(uint32_t color);
#line 730 "/Users/gabriel/Documents/Arduino/game/game.ino"
bool processNotes(uint8_t buttonColumn, float currentTime);
#line 779 "/Users/gabriel/Documents/Arduino/game/game.ino"
void handleButtonPress(bool button1, bool button2, bool button3, bool button4);
#line 828 "/Users/gabriel/Documents/Arduino/game/game.ino"
void activateTaser();
#line 119 "/Users/gabriel/Documents/Arduino/game/game.ino"
void actionKeyIncreaseVolume(bool active, int pin, void *ptr)
{
  if (active)
  {
    volume += 0.1;
    if (volume > 1.0)
      volume = 1.0; // Max volume
    i2s.setVolume(volume);
    Serial.print("Volume increased to: ");
    Serial.println(volume);
  }
}

// Action function for decreasing the volume
void actionKeyDecreaseVolume(bool active, int pin, void *ptr)
{
  if (active)
  {
    volume -= 0.1;
    if (volume < 0.0)
      volume = 0.0; // Min volume
    i2s.setVolume(volume);
    Serial.print("Volume decreased to: ");
    Serial.println(volume);
  }
}

// Setup actions for buttons
void setupActions()
{
  auto act_low = AudioActions::ActiveLow;

  // Assign button 1 to increase volume and button 2 to decrease volume
  // i2s.audioActions().add(i2s.getKey(2), actionKeyIncreaseVolume, NULL, act_low, NULL);
  // i2s.audioActions().add(i2s.getKey(3), actionKeyDecreaseVolume, NULL, act_low, NULL);
}

void setupTiles()
{
  Serial.printf("--- Setting up tiles ---\n");
  // char songConfigFileName[strlen(songName) + 15];
  // snprintf(songConfigFileName, sizeof(songConfigFileName), "/songs/%s.json", songName);

  // Serial.printf("Opening song config file %s\n", songConfigFileName);
  // songConfigFile = SD.open(songConfigFileName);
  // if (!songConfigFile) {
  //   Serial.println("Failed to open song config file!");
  //   return;
  // }
  // String songConfigFileContents = songConfigFile.readString();
  // Serial.printf("Config file contents: %s\n", songConfigFileContents);

  // JsonDocument doc;
  // DeserializationError error = deserializeJson(doc, songConfigFileContents);
  // songConfigFile.close(); // Close file after reading

  // if (error) {
  //   Serial.print("JSON parsing failed: ");
  //   Serial.println(error.f_str());
  //   return;
  // }

  // const char* mapping;
  // const char* srcref;

  // mapping = doc["mapping"];
  // srcref = doc["srcref"];
  // const char *mapping = "{\"version\":1,\"title\":\"\",\"startAt\":null,\"endAt\":null,\"keys\":4,\"difficulty\":1,\"length\":224.82,\"noteCount\":349,\"visualizerName\":\"\",\"clonedFrom\":\"\",\"mappings\":[{\"t\":9.286,\"k\":\"d\"},{\"t\":12.425,\"k\":\"f\"},{\"t\":15.333,\"k\":\"j\"},{\"t\":17.267,\"k\":\"k\"},{\"t\":18.957,\"k\":\"f\"},{\"t\":19.785,\"k\":\"f\"},{\"t\":25.614,\"k\":\"d\"},{\"t\":28.868,\"k\":\"j\"},{\"t\":32.015,\"k\":\"d\"},{\"t\":32.205,\"k\":\"k\"},{\"t\":33.772,\"k\":\"d\",\"h\":{\"d\":34.73636401335144}},{\"t\":36.69,\"k\":\"k\",\"h\":{\"k\":38.032124908447265}},{\"t\":39.113,\"k\":\"f\",\"h\":{\"f\":40.41450008392334}},{\"t\":42.247,\"k\":\"j\",\"h\":{\"j\":43.47073504196167}},{\"t\":44.251,\"k\":\"d\",\"h\":{\"d\":45.48130982643127}},{\"t\":51.135,\"k\":\"k\",\"h\":{\"k\":52.39404503433227}},{\"t\":51.197,\"k\":\"d\",\"h\":{\"d\":52.44504491416931}},{\"t\":53.265,\"k\":\"k\",\"h\":{\"k\":53.59533594087219}},{\"t\":53.732,\"k\":\"k\",\"h\":{\"k\":54.95999795422363}},{\"t\":55.087,\"k\":\"k\",\"h\":{\"k\":57.646980091552734}},{\"t\":60.27,\"k\":\"d\"},{\"t\":60.564,\"k\":\"k\"},{\"t\":60.901,\"k\":\"k\"},{\"t\":61.282,\"k\":\"k\"},{\"t\":61.396,\"k\":\"d\"},{\"t\":61.603,\"k\":\"k\"},{\"t\":61.865,\"k\":\"d\"},{\"t\":62.13,\"k\":\"k\"},{\"t\":62.507,\"k\":\"d\"},{\"t\":62.74,\"k\":\"k\"},{\"t\":62.998,\"k\":\"d\"},{\"t\":63.189,\"k\":\"k\"},{\"t\":63.793,\"k\":\"d\"},{\"t\":63.964,\"k\":\"k\"},{\"t\":64.635,\"k\":\"j\"},{\"t\":65.298,\"k\":\"f\"},{\"t\":65.488,\"k\":\"j\"},{\"t\":65.733,\"k\":\"f\"},{\"t\":67.365,\"k\":\"j\"},{\"t\":67.49,\"k\":\"f\"},{\"t\":67.687,\"k\":\"j\"},{\"t\":69.342,\"k\":\"d\"},{\"t\":69.485,\"k\":\"k\"},{\"t\":70.484,\"k\":\"j\"},{\"t\":71.001,\"k\":\"d\"},{\"t\":72.117,\"k\":\"f\"},{\"t\":72.743,\"k\":\"d\"},{\"t\":73.337,\"k\":\"d\"},{\"t\":73.629,\"k\":\"d\"},{\"t\":73.865,\"k\":\"d\"},{\"t\":74.17,\"k\":\"d\",\"h\":{\"d\":75.59835706294251}},{\"t\":76.168,\"k\":\"j\",\"h\":{\"j\":79.56983505149842}},{\"t\":77.869,\"k\":\"d\",\"h\":{\"d\":79.56083498855591}},{\"t\":80.876,\"k\":\"d\"},{\"t\":81.51,\"k\":\"k\"},{\"t\":82.217,\"k\":\"j\"},{\"t\":83.604,\"k\":\"d\"},{\"t\":85.121,\"k\":\"d\"},{\"t\":85.419,\"k\":\"f\"},{\"t\":86.509,\"k\":\"k\"},{\"t\":87.053,\"k\":\"k\"},{\"t\":87.412,\"k\":\"k\"},{\"t\":87.606,\"k\":\"k\"},{\"t\":87.832,\"k\":\"k\"},{\"t\":88.045,\"k\":\"k\"},{\"t\":88.296,\"k\":\"k\"},{\"t\":89.762,\"k\":\"f\"},{\"t\":90.147,\"k\":\"d\"},{\"t\":92,\"k\":\"k\"},{\"t\":92.449,\"k\":\"j\"},{\"t\":93.086,\"k\":\"k\"},{\"t\":93.347,\"k\":\"k\"},{\"t\":93.748,\"k\":\"j\"},{\"t\":93.936,\"k\":\"j\"},{\"t\":94.229,\"k\":\"j\"},{\"t\":94.482,\"k\":\"j\"},{\"t\":94.616,\"k\":\"f\"},{\"t\":94.963,\"k\":\"j\"},{\"t\":95.362,\"k\":\"f\"},{\"t\":95.911,\"k\":\"f\"},{\"t\":96.092,\"k\":\"j\"},{\"t\":96.326,\"k\":\"f\"},{\"t\":96.515,\"k\":\"j\"},{\"t\":96.729,\"k\":\"f\"},{\"t\":96.893,\"k\":\"k\"},{\"t\":97.078,\"k\":\"f\"},{\"t\":97.267,\"k\":\"k\"},{\"t\":97.446,\"k\":\"f\"},{\"t\":97.65,\"k\":\"j\"},{\"t\":97.793,\"k\":\"f\"},{\"t\":98.003,\"k\":\"j\"},{\"t\":98.213,\"k\":\"f\"},{\"t\":98.364,\"k\":\"k\"},{\"t\":98.75,\"k\":\"f\"},{\"t\":99.136,\"k\":\"j\"},{\"t\":99.686,\"k\":\"d\"},{\"t\":100.148,\"k\":\"d\"},{\"t\":100.544,\"k\":\"d\"},{\"t\":100.923,\"k\":\"d\"},{\"t\":101.361,\"k\":\"d\"},{\"t\":101.835,\"k\":\"k\",\"h\":{\"k\":103.51463488746643}},{\"t\":103.764,\"k\":\"f\",\"h\":{\"f\":104.74087892179871}},{\"t\":106.078,\"k\":\"j\",\"h\":{\"j\":108.95916378446961}},{\"t\":109.286,\"k\":\"d\",\"h\":{\"d\":110.16422187792969}},{\"t\":110.092,\"k\":\"k\",\"h\":{\"k\":111.51699904577637}},{\"t\":111.571,\"k\":\"d\"},{\"t\":111.715,\"k\":\"k\",\"h\":{\"k\":112.0663579332428}},{\"t\":112.024,\"k\":\"d\",\"h\":{\"d\":112.34210492370606}},{\"t\":112.482,\"k\":\"k\"},{\"t\":112.684,\"k\":\"d\"},{\"t\":112.902,\"k\":\"j\",\"h\":{\"j\":113.38409218119811}},{\"t\":113.393,\"k\":\"f\",\"h\":{\"f\":113.71581616593933}},{\"t\":115.025,\"k\":\"k\",\"h\":{\"k\":115.44150289700318}},{\"t\":115.428,\"k\":\"d\"},{\"t\":115.632,\"k\":\"k\",\"h\":{\"k\":116.08103807057189}},{\"t\":116.377,\"k\":\"j\"},{\"t\":116.745,\"k\":\"j\"},{\"t\":116.931,\"k\":\"j\"},{\"t\":117.096,\"k\":\"j\"},{\"t\":117.258,\"k\":\"j\"},{\"t\":117.414,\"k\":\"j\"},{\"t\":117.745,\"k\":\"j\",\"h\":{\"j\":119.7414520553131}},{\"t\":119.995,\"k\":\"d\",\"h\":{\"d\":120.43039704768371}},{\"t\":120.364,\"k\":\"f\",\"h\":{\"f\":121.06434917929077}},{\"t\":122.95,\"k\":\"d\",\"h\":{\"d\":123.49254704768371}},{\"t\":123.246,\"k\":\"k\",\"h\":{\"k\":124.24471597138977}},{\"t\":124.405,\"k\":\"d\"},{\"t\":124.903,\"k\":\"d\"},{\"t\":125.485,\"k\":\"kf\",\"h\":{\"k\":125.96284880545043}},{\"t\":125.844,\"k\":\"f\"},{\"t\":126.079,\"k\":\"j\",\"h\":{\"j\":126.44314616403199}},{\"t\":126.312,\"k\":\"d\"},{\"t\":126.579,\"k\":\"k\"},{\"t\":126.761,\"k\":\"f\"},{\"t\":126.961,\"k\":\"j\"},{\"t\":127.194,\"k\":\"d\"},{\"t\":127.575,\"k\":\"d\"},{\"t\":128.009,\"k\":\"j\",\"h\":{\"j\":128.324096}},{\"t\":128.195,\"k\":\"f\",\"h\":{\"f\":128.52977705722046}},{\"t\":128.509,\"k\":\"j\"},{\"t\":128.783,\"k\":\"fk\"},{\"t\":129.045,\"k\":\"k\"},{\"t\":129.286,\"k\":\"d\",\"h\":{\"d\":129.63016516403198}},{\"t\":129.531,\"k\":\"k\"},{\"t\":129.744,\"k\":\"j\"},{\"t\":129.953,\"k\":\"d\"},{\"t\":130.13,\"k\":\"k\"},{\"t\":130.5,\"k\":\"kf\",\"h\":{\"f\":130.8910600858307}},{\"t\":130.763,\"k\":\"j\",\"h\":{\"j\":131.28472186839295}},{\"t\":131.447,\"k\":\"j\",\"h\":{\"j\":133.03359397329712}},{\"t\":133.297,\"k\":\"k\",\"h\":{\"k\":134.19916689891053}},{\"t\":134.121,\"k\":\"d\",\"h\":{\"d\":134.87569801335144}},{\"t\":134.992,\"k\":\"f\",\"h\":{\"f\":135.53196601335145}},{\"t\":135.55,\"k\":\"j\"},{\"t\":136.027,\"k\":\"j\"},{\"t\":136.484,\"k\":\"k\",\"h\":{\"k\":136.84375505340577}},{\"t\":137.061,\"k\":\"f\",\"h\":{\"f\":137.73667000953674}},{\"t\":138.375,\"k\":\"d\",\"h\":{\"d\":138.79716491607667}},{\"t\":138.732,\"k\":\"k\",\"h\":{\"k\":139.42555500572203}},{\"t\":139.231,\"k\":\"f\",\"h\":{\"f\":139.9238079408722}},{\"t\":139.712,\"k\":\"j\",\"h\":{\"j\":140.50523589318848}},{\"t\":141.71,\"k\":\"f\",\"h\":{\"f\":142.10464093515014}},{\"t\":141.994,\"k\":\"k\"},{\"t\":142.354,\"k\":\"dk\",\"h\":{\"k\":142.83133000190736}},{\"t\":142.933,\"k\":\"d\",\"h\":{\"d\":143.85835802098083}},{\"t\":143.811,\"k\":\"k\",\"h\":{\"k\":144.68766395994567}},{\"t\":143.945,\"k\":\"f\"},{\"t\":145.14,\"k\":\"j\",\"h\":{\"j\":145.58430395803833}},{\"t\":145.622,\"k\":\"f\"},{\"t\":145.808,\"k\":\"k\",\"h\":{\"k\":146.20557487220765}},{\"t\":146.09,\"k\":\"f\"},{\"t\":146.71,\"k\":\"d\"},{\"t\":147.091,\"k\":\"d\"},{\"t\":148.499,\"k\":\"k\"},{\"t\":148.744,\"k\":\"k\"},{\"t\":148.949,\"k\":\"k\"},{\"t\":149.149,\"k\":\"k\"},{\"t\":149.349,\"k\":\"k\"},{\"t\":149.558,\"k\":\"k\"},{\"t\":149.75,\"k\":\"k\"},{\"t\":149.944,\"k\":\"k\"},{\"t\":150.161,\"k\":\"k\"},{\"t\":150.596,\"k\":\"j\"},{\"t\":151.144,\"k\":\"f\",\"h\":{\"f\":151.8226101449585}},{\"t\":151.941,\"k\":\"d\"},{\"t\":152.341,\"k\":\"d\",\"h\":{\"d\":152.71926001716614}},{\"t\":152.686,\"k\":\"k\",\"h\":{\"k\":152.9948800076294}},{\"t\":152.89,\"k\":\"d\"},{\"t\":153.101,\"k\":\"k\"},{\"t\":153.275,\"k\":\"d\"},{\"t\":153.424,\"k\":\"k\"},{\"t\":153.611,\"k\":\"dk\"},{\"t\":153.861,\"k\":\"kd\"},{\"t\":154.091,\"k\":\"k\"},{\"t\":154.193,\"k\":\"d\"},{\"t\":154.339,\"k\":\"k\"},{\"t\":154.516,\"k\":\"k\"},{\"t\":154.574,\"k\":\"d\"},{\"t\":154.726,\"k\":\"k\"},{\"t\":154.897,\"k\":\"d\"},{\"t\":154.949,\"k\":\"k\"},{\"t\":155.128,\"k\":\"k\"},{\"t\":155.246,\"k\":\"d\",\"h\":{\"d\":157.0774719847412}},{\"t\":155.356,\"k\":\"k\",\"h\":{\"k\":157.0834717882843}},{\"t\":158.095,\"k\":\"kd\",\"h\":{\"k\":158.92853892179872,\"d\":158.93753898474122}},{\"t\":159.273,\"k\":\"kd\"},{\"t\":159.444,\"k\":\"k\"},{\"t\":159.5,\"k\":\"d\"},{\"t\":159.643,\"k\":\"k\"},{\"t\":159.743,\"k\":\"d\"},{\"t\":159.842,\"k\":\"k\"},{\"t\":159.975,\"k\":\"d\"},{\"t\":160.026,\"k\":\"k\"},{\"t\":160.211,\"k\":\"dk\"},{\"t\":160.443,\"k\":\"kd\"},{\"t\":160.66,\"k\":\"k\"},{\"t\":160.719,\"k\":\"d\"},{\"t\":160.894,\"k\":\"k\"},{\"t\":160.98,\"k\":\"d\"},{\"t\":161.112,\"k\":\"k\"},{\"t\":161.21,\"k\":\"d\"},{\"t\":161.327,\"k\":\"k\"},{\"t\":161.44,\"k\":\"d\"},{\"t\":161.519,\"k\":\"k\"},{\"t\":161.705,\"k\":\"dk\"},{\"t\":161.909,\"k\":\"k\"},{\"t\":161.975,\"k\":\"d\"},{\"t\":162.196,\"k\":\"j\"},{\"t\":162.325,\"k\":\"f\"},{\"t\":162.499,\"k\":\"j\"},{\"t\":162.699,\"k\":\"fj\"},{\"t\":162.949,\"k\":\"j\"},{\"t\":163.147,\"k\":\"j\"},{\"t\":163.339,\"k\":\"j\"},{\"t\":163.515,\"k\":\"j\"},{\"t\":163.705,\"k\":\"j\"},{\"t\":163.922,\"k\":\"j\"},{\"t\":164.135,\"k\":\"j\"},{\"t\":164.36,\"k\":\"j\"},{\"t\":164.56,\"k\":\"j\"},{\"t\":164.792,\"k\":\"fj\"},{\"t\":165.039,\"k\":\"f\"},{\"t\":165.108,\"k\":\"j\"},{\"t\":165.292,\"k\":\"fj\"},{\"t\":165.489,\"k\":\"fj\"},{\"t\":168.48,\"k\":\"jd\"},{\"t\":168.661,\"k\":\"j\"},{\"t\":168.714,\"k\":\"d\"},{\"t\":168.855,\"k\":\"j\"},{\"t\":168.924,\"k\":\"d\"},{\"t\":169.05,\"k\":\"j\"},{\"t\":169.166,\"k\":\"d\"},{\"t\":169.258,\"k\":\"j\"},{\"t\":169.405,\"k\":\"d\"},{\"t\":169.479,\"k\":\"j\"},{\"t\":169.656,\"k\":\"dj\"},{\"t\":169.9,\"k\":\"jd\"},{\"t\":170.108,\"k\":\"j\"},{\"t\":170.176,\"k\":\"d\"},{\"t\":170.338,\"k\":\"j\"},{\"t\":170.426,\"k\":\"d\"},{\"t\":170.555,\"k\":\"j\"},{\"t\":170.725,\"k\":\"d\"},{\"t\":171.021,\"k\":\"j\"},{\"t\":171.276,\"k\":\"d\"},{\"t\":171.874,\"k\":\"f\"},{\"t\":173.398,\"k\":\"f\"},{\"t\":173.845,\"k\":\"f\"},{\"t\":174.21,\"k\":\"f\"},{\"t\":174.472,\"k\":\"k\"},{\"t\":175.306,\"k\":\"k\"},{\"t\":175.505,\"k\":\"k\"},{\"t\":176.992,\"k\":\"d\"},{\"t\":179.054,\"k\":\"f\"},{\"t\":180.892,\"k\":\"j\"},{\"t\":182.122,\"k\":\"k\"},{\"t\":182.711,\"k\":\"k\"},{\"t\":183.217,\"k\":\"k\"},{\"t\":184.007,\"k\":\"k\"},{\"t\":184.255,\"k\":\"k\"},{\"t\":184.52,\"k\":\"k\"},{\"t\":185.555,\"k\":\"k\"},{\"t\":185.728,\"k\":\"k\"},{\"t\":185.904,\"k\":\"k\"},{\"t\":186.061,\"k\":\"k\"},{\"t\":186.294,\"k\":\"k\"},{\"t\":186.479,\"k\":\"k\"},{\"t\":186.871,\"k\":\"k\"},{\"t\":187.041,\"k\":\"k\"},{\"t\":187.271,\"k\":\"k\"},{\"t\":187.486,\"k\":\"k\"},{\"t\":187.691,\"k\":\"k\"},{\"t\":187.906,\"k\":\"k\"},{\"t\":188.299,\"k\":\"f\"},{\"t\":190.495,\"k\":\"j\"},{\"t\":190.672,\"k\":\"j\"},{\"t\":190.826,\"k\":\"j\"},{\"t\":190.98,\"k\":\"j\",\"h\":{\"j\":191.55388691798402}},{\"t\":191.607,\"k\":\"j\",\"h\":{\"j\":192.3911270972748}},{\"t\":192.802,\"k\":\"f\"},{\"t\":193.455,\"k\":\"k\",\"h\":{\"k\":193.85534693133545}},{\"t\":193.871,\"k\":\"d\",\"h\":{\"d\":194.30681811253356}},{\"t\":194.27,\"k\":\"k\",\"h\":{\"k\":194.9047339923706}},{\"t\":194.845,\"k\":\"d\"},{\"t\":195.007,\"k\":\"k\",\"h\":{\"k\":195.386292}},{\"t\":195.309,\"k\":\"d\"},{\"t\":195.52,\"k\":\"k\"},{\"t\":195.737,\"k\":\"d\"},{\"t\":195.87,\"k\":\"j\",\"h\":{\"j\":196.353502043869}},{\"t\":196.259,\"k\":\"f\"},{\"t\":197.941,\"k\":\"d\",\"h\":{\"d\":198.63983219073486}},{\"t\":198.988,\"k\":\"d\"},{\"t\":199.272,\"k\":\"j\"},{\"t\":199.66,\"k\":\"k\"},{\"t\":200.24,\"k\":\"j\"},{\"t\":200.459,\"k\":\"k\"},{\"t\":200.642,\"k\":\"k\"},{\"t\":200.855,\"k\":\"k\"},{\"t\":201.059,\"k\":\"j\"},{\"t\":201.592,\"k\":\"f\"},{\"t\":201.785,\"k\":\"d\"},{\"t\":202.54,\"k\":\"d\"},{\"t\":202.662,\"k\":\"f\"},{\"t\":203.063,\"k\":\"j\"},{\"t\":203.24,\"k\":\"k\",\"h\":{\"k\":203.5572478703003}},{\"t\":204.612,\"k\":\"k\"},{\"t\":204.87,\"k\":\"j\"},{\"t\":205.346,\"k\":\"f\"},{\"t\":205.889,\"k\":\"d\",\"h\":{\"d\":207.96821301716614}},{\"t\":208.586,\"k\":\"k\"},{\"t\":208.911,\"k\":\"j\",\"h\":{\"j\":210.30360202288819}},{\"t\":210.669,\"k\":\"f\"},{\"t\":211.822,\"k\":\"d\",\"h\":{\"d\":212.47827597520447}},{\"t\":213.687,\"k\":\"d\"},{\"t\":213.882,\"k\":\"f\"},{\"t\":214.142,\"k\":\"f\"},{\"t\":215.102,\"k\":\"j\"},{\"t\":215.34,\"k\":\"j\"},{\"t\":215.545,\"k\":\"k\"},{\"t\":215.773,\"k\":\"k\"},{\"t\":216.821,\"k\":\"k\"},{\"t\":216.954,\"k\":\"j\"},{\"t\":217.352,\"k\":\"f\"},{\"t\":217.456,\"k\":\"d\"},{\"t\":217.787,\"k\":\"d\",\"h\":{\"d\":218.75808881307984}},{\"t\":218.737,\"k\":\"f\"},{\"t\":219.178,\"k\":\"j\"},{\"t\":219.319,\"k\":\"k\"},{\"t\":219.82,\"k\":\"kd\",\"h\":{\"k\":220.5681130267029,\"d\":220.64469489700318}}]}";
  // const char *srcref = "a7xmtBHWgE";
  // float length = 224.82;
  // int noteCount = 349;
  const char *srcref;
  float length;
  int noteCount;
  const char *mapping;
  Serial.println("Waiting for user to pick song");
  while (true)
  {
    int selected = -1;
    bool button1 = !digitalRead(BUTTON_1_PIN);
    if (button1)
      selected = 0;
    bool button2 = !digitalRead(BUTTON_2_PIN);
    if (button2)
      selected = 1;
    bool button3 = !digitalRead(BUTTON_3_PIN);
    if (button3)
      selected = 2;
    bool button4 = !digitalRead(BUTTON_4_PIN);
    if (button4)
      selected = 3;

    if (selected == 3)
    {
      Serial.println("There is no song mapped to 3");
    }
    else if (selected != -1)
    {
      Serial.printf("User selected %d\n", selected);
      pianoLoading = true;
      srcref = piano_games[selected].srcref;
      length = piano_games[selected].length;
      noteCount = piano_games[selected].noteCount;
      mapping = piano_games[selected].mapping;
      break;
    }
  }

  // Serial.print("Mapping: ");
  // Serial.println(mapping ? mapping : "Not found");

  // Serial.print("SrcRef: ");
  // Serial.println(srcref ? srcref : "Not found");

  if (!mapping || !srcref)
  {
    Serial.println("Returning because mapping/srcref are not set");
    return;
  }

  totalNotes = noteCount;
  songLength = length;
  getMappings(mapping);
  for (int i = 0; i < totalNotes; i++)
  {
    piano_note_t note = notes[i];
    printNote(note);
  }
  char songFileName[strlen(srcref) + 11];
  snprintf(songFileName, sizeof(songFileName), "/mp3s/%s.mp3", srcref);
  Serial.printf("Song config file name: %s\n", songFileName);

  audioFile = SD.open(songFileName);

  if (!audioFile)
  {
    Serial.println("Failed to open song");
    return;
  }

  Serial.println("Setting up audio 1");
  decoder.begin();
  Serial.println("Setting up audio 2");
  copier.begin(decoder, audioFile);
  Serial.println("Set up audio file successfully");
  playing = true;
  startTime = millis();
  currentTime = millis();
  secondsElapsed = 0;
}

void getMappings(const char *mapping)
{
  JsonDocument doc;
  DeserializationError error = deserializeJson(doc, mapping);

  if (error)
  {
    Serial.print("JSON parsing of mapping failed: ");
    Serial.println(error.f_str());
    return;
  }

  notes = (piano_note_t *)malloc(sizeof(piano_note_t) * 800);
  int i = 0;
  JsonArray nestedArr = doc["mappings"];
  for (JsonVariant v : nestedArr)
  {
    JsonObject obj = v.as<JsonObject>();
    i = addNotesFromJson(obj, i);
    Serial.printf("New i: %d\n", i);
  }
  totalNotes = i;
}

int addNotesFromJson(JsonObject obj, int i)
{
  // Get the note start time. (Assume the JSON has a key "t".)
  float noteStart = obj["t"];

  // The JSON field "k" is a string that tells us which keys are active.
  String keys = obj["k"];

  // The JSON object "h" holds the ending times for each key.
  JsonObject h = obj["h"];

  // For each key (d, f, j, k) present in the keys string,
  // create a separate note.

  // For key "d"
  if (keys.indexOf('d') != -1)
  {
    notes[i].time = noteStart;
    // If the JSON value for h["d"] exists and is a float, then subtract noteStart to get the duration.
    notes[i].height = h["d"].is<float>() ? h["d"].as<float>() - noteStart : ZERO_WIDTH;
    notes[i].col = PIANO_NOTE_D;
    notes[i].color = colColors[0];
    notes[i].hit = false;
    notes[i].recognizedNotHit = false;
    i++;
  }

  // For key "f"
  if (keys.indexOf('f') != -1)
  {
    notes[i].time = noteStart;
    notes[i].height = h["f"].is<float>() ? h["f"].as<float>() - noteStart : ZERO_WIDTH;
    notes[i].col = PIANO_NOTE_F;
    notes[i].color = colColors[1];
    notes[i].hit = false;
    notes[i].recognizedNotHit = false;
    i++;
  }

  // For key "j"
  if (keys.indexOf('j') != -1)
  {
    notes[i].time = noteStart;
    notes[i].height = h["j"].is<float>() ? h["j"].as<float>() - noteStart : ZERO_WIDTH;
    notes[i].col = PIANO_NOTE_J;
    notes[i].color = colColors[2];
    notes[i].hit = false;
    notes[i].recognizedNotHit = false;
    i++;
  }

  // For key "k"
  if (keys.indexOf('k') != -1)
  {
    notes[i].time = noteStart;
    notes[i].height = h["k"].is<float>() ? h["k"].as<float>() - noteStart : ZERO_WIDTH;
    notes[i].col = PIANO_NOTE_K;
    notes[i].color = colColors[3];
    notes[i].hit = false;
    notes[i].recognizedNotHit = false;
    i++;
  }

  // Return the new free index in the notes array.
  return i;
}

// void displayNotes()
// {
//   // Clear the LED strip for a fresh display.
//   FastLED.clear();

//   // Each column gets this many LEDs.
//   int colSegment = NUM_LEDS / NUM_COLS; // e.g., 120 / 4 = 30 LEDs per column

//   // Loop through all notes.
//   for (int i = 0; i < totalNotes; i++)
//   {

//     float noteStart = notes[i].time;             // When the note starts.
//     float noteEnd = noteStart + notes[i].height; // When the note ends.

//     // Skip notes that are completely outside the current display window.
//     if (noteEnd <= secondsElapsed || noteStart >= (secondsElapsed + WINDOW_LENGTH))
//     {
//       if(noteEnd <= secondsElapsed && !notes[i].hit && !notes[i].recognizedNotHit) {
//         // This guy is considered a "miss"
//         notes[i].recognizedNotHit = true;
//         // Serial.println("Missed, adding damage :(");
//         // Serial.printf("New damageUntil=%lu\n", damageUntil);
//         damageUntil = millis() + 500;
//         incorrectHits++;
//         if(incorrectHits == MAX_FAILURES) {
//           activateTaser();
//         }
//       }
//       continue;
//     }

//     // Clip the note's boundaries to the display window.
//     float effectiveStart = (noteStart < secondsElapsed) ? secondsElapsed : noteStart;
//     float effectiveEnd = (noteEnd > secondsElapsed + WINDOW_LENGTH) ? (secondsElapsed + WINDOW_LENGTH) : noteEnd;

//     // Determine the relative position within the window (0 to 10 sec).
//     float relStart = effectiveStart - secondsElapsed;
//     float relEnd = effectiveEnd - secondsElapsed;

//     // Map relative time to LED indices within the column.
//     int ledStart = (int)(relStart * (colSegment / WINDOW_LENGTH));
//     int ledEnd = (int)(relEnd * (colSegment / WINDOW_LENGTH));
//     if (ledEnd <= ledStart)
//     {
//       ledEnd = ledStart + 1; // Light at least one LED.
//     }

//     // Compute the starting index of the column.
//     int baseIndex = notes[i].col * colSegment;

//     // Light the LEDs for this note.
//     for (int led = baseIndex + ledStart; led < baseIndex + ledEnd && led < baseIndex + colSegment; led++)
//     {
//       leds[led] = notes[i].color;
//     }
//   }
//   // Serial.printf("millis()=%lu, damageUntil=%lu\n", millis(), damageUntil);
//   if (millis() < damageUntil)
//   {
//     // Serial.println("Setting all cols to red");
//     for (int col = 0; col < NUM_COLS; col++)
//     {
//       for (int i = 0; i < 4; i++)
//       {
//         leds[i + col * colSegment] = redColor;
//       }
//     }
//   }

//   // Update the LED strip.
//   FastLED.show();
// }

void displayNotes()
{
  // Clear the LED strip for a fresh display.
  FastLED.clear();

  // Each column gets this many LEDs.
  int colSegment = NUM_LEDS / NUM_COLS; // For example, 120 / 4 = 30 LEDs per column

  // Loop through all notes.
  for (int i = 0; i < totalNotes; i++)
  {
    float noteStart = notes[i].time;             // When the note starts.
    float noteEnd = noteStart + notes[i].height; // When the note ends.

    // Skip notes that are completely outside the current display window.
    if (noteEnd <= secondsElapsed || noteStart >= (secondsElapsed + WINDOW_LENGTH))
    {
      // If the note has passed without being hit, mark a miss.
      if (noteEnd <= secondsElapsed && !notes[i].hit && !notes[i].recognizedNotHit)
      {
        notes[i].recognizedNotHit = true;
        damageUntil = millis() + 500;
        incorrectHits++;
        if (incorrectHits == MAX_FAILURES)
        {
          taserActivated = true;
        }
      }
      continue;
    }

    // Clip the note's boundaries to the display window.
    float effectiveStart = (noteStart < secondsElapsed) ? secondsElapsed : noteStart;
    float effectiveEnd = (noteEnd > secondsElapsed + WINDOW_LENGTH) ? (secondsElapsed + WINDOW_LENGTH) : noteEnd;

    // Determine the relative position within the window.
    float relStart = effectiveStart - secondsElapsed;
    float relEnd = effectiveEnd - secondsElapsed;

    // Map relative time to LED indices within the column (in normal order).
    int originalLedStart = (int)(relStart * (colSegment / WINDOW_LENGTH));
    int originalLedEnd = (int)(relEnd * (colSegment / WINDOW_LENGTH));
    if (originalLedEnd <= originalLedStart)
    {
      originalLedEnd = originalLedStart + 1; // Ensure at least one LED is lit.
    }

    // Flip the indices. (0 now becomes the top of the column.)
    int flippedStart = colSegment - originalLedEnd;
    int flippedEnd = colSegment - originalLedStart;

    // Compute the starting index of the column in the overall LED array.
    int baseIndex = notes[i].col * colSegment;

    // Light the LEDs for this note with the flipped ordering.
    for (int led = baseIndex + flippedStart; led < baseIndex + flippedEnd && led < baseIndex + colSegment; led++)
    {
      leds[led] = notes[i].color;
    }
  }

  // If damage is active, now fill the top 4 LEDs (instead of the bottom) in each column with red.
  if (millis() < damageUntil)
  {
    for (int col = 0; col < NUM_COLS; col++)
    {
      int baseIndex = col * colSegment;
      // Top 4 LEDs: these are the last 4 indices in this column.
      for (int i = 0; i < 4; i++)
      {
        leds[baseIndex + (colSegment - 4) + i] = redColor;
      }
    }
  }

  // Update the LED strip.
  FastLED.show();
}

void setup()
{
  // Wire.setPins(I2C_SDA_PIN, I2C_SCL_PIN);
  Serial.begin(115200);
  pinMode(BUTTON_1_PIN, INPUT_PULLUP);
  pinMode(BUTTON_2_PIN, INPUT_PULLUP);
  pinMode(BUTTON_3_PIN, INPUT_PULLUP);
  pinMode(BUTTON_4_PIN, INPUT_PULLUP);
  pinMode(TASER_PIN, OUTPUT);
  digitalWrite(TASER_PIN, LOW);
  // AudioToolsLogger.begin(Serial, AudioToolsLogLevel::Info);

  Serial.println("--- Piano Tiles starting! ---");
  // Seesaw
  //  Serial.println(F("Waiting for seesaw to start..."));
  // if(!ss.begin()){
  //   while(1) delay(10);
  // }
  // Serial.println(F("Seesaw started..."));

  // Set up button actions
  setupActions();
  // Setup audiokit before SD
  setupAudio((void *)0);

  // Setup file
  SD.begin(chipSelect);

  // FastLED.addLeds<NEOPIXEL, 21>(leds, NUM_LEDS);
  // FastLED.clear();
  // FastLED.show();
  xTaskCreatePinnedToCore(
      setupLEDs,  /* Function to implement the task */
      "Task1",    /* Name of the task */
      10000,      /* Stack size in words */
      NULL,       /* Task input parameter */
      0,          /* Priority of the task */
      &audioTask, /* Task handle. */
      0);         /* Core where the task should run */
  setupTiles();
  gameOn = true;
  pianoLoading = false;
}

void loop()
{
  // Serial.print("Audio running on core: ");
  // Serial.println(xPortGetCoreID());
  if (playing)
  {
    if(taserActivated) {
      activateTaser();
    }

    copier.copy();
    currentTime = millis();
    secondsElapsed = (currentTime - startTime) / 1000.0;
    // Serial.printf("Seconds elapsed %9.6f\n", secondsElapsed);
    bool button1 = !digitalRead(BUTTON_1_PIN);
    bool button2 = !digitalRead(BUTTON_2_PIN);
    bool button3 = !digitalRead(BUTTON_3_PIN);
    bool button4 = !digitalRead(BUTTON_4_PIN);
    handleButtonPress(button1, button2, button3, button4);
  }

  i2s.processActions(); // Process individual button actions

  // Read both button states
  // bool button1State = !digitalRead(i2s.getKey(1)); // Assuming active-low
  // bool button2State = !digitalRead(i2s.getKey(2)); // Assuming active-low

  // // Check if both are pressed at the same time
  // if (button1State && button2State)
  // {
  //   Serial.println("Both buttons pressed!");
  //   onBothButtonsPressed(); // Call function for this action
  // }
}

void setupLEDs(void *params)
{
  FastLED.addLeds<NEOPIXEL, 22>(leds, NUM_LEDS);
  FastLED.setBrightness(BRIGHTNESS);
  FastLED.clear();
  // driver.initled((uint8_t*)leds,pins,NUMSTRIPS,NUM_LED_PER_STRIP,ORDER_GRBW);
  FastLED.setBrightness(BRIGHTNESS);
  FastLED.show();
  // Serial.print("LED Task running on core: ");
  // Serial.println(xPortGetCoreID());
  runLEDs();
}

void runLEDs()
{
  for (;;)
  {
    if (taserActivated) {
      Serial.println("Activating red lights for taser");
      FastLED.setBrightness(BRIGHTNESS);
      fill_solid(leds, NUM_LEDS, CRGB::Red);
      FastLED.show();
    }
    else if (pianoLoading)
    {
      FastLED.setBrightness(BRIGHTNESS);
      fill_solid(leds, NUM_LEDS, CRGB::White);
      FastLED.show();
    }
    else if (!gameOn)
    {
      FastLED.setBrightness(BRIGHTNESS);
      uint8_t thisHue = beat8(10, 255);
      fill_rainbow(leds, NUM_LEDS, thisHue, 10);
      FastLED.show();
    } else
    {
      FastLED.setBrightness(BRIGHTNESS);
      displayNotes();
    }
  }
}

void setupAudio(void *params)
{
  auto config = i2s.defaultConfig(TX_MODE);
  config.sd_active = true;
  i2s.begin(config);

  // Setup I2S based on sampling rate provided by decoder
  i2s.setVolume(volume); // Set initial volume
  // audioPlayer();
}

void audioPlayer()
{
  for (;;)
  {
    if (playing)
    {
      copier.copy();
    }
  }
}

void printNote(piano_note_t note)
{
  Serial.print("Note<Time: ");
  Serial.print(note.time, 2); // Print the time with two decimals
  Serial.print(" sec, Duration: ");
  Serial.print(note.height, 2); // The note's duration
  Serial.print(" sec, Column: ");
  // Convert the column enum to its corresponding letter.
  char colLetter;
  switch (note.col)
  {
  case PIANO_NOTE_D:
    colLetter = 'd';
    break;
  case PIANO_NOTE_F:
    colLetter = 'f';
    break;
  case PIANO_NOTE_J:
    colLetter = 'j';
    break;
  case PIANO_NOTE_K:
    colLetter = 'k';
    break;
  default:
    colLetter = '?';
    break;
  }
  Serial.print(colLetter);

  // Print the color as HSV values.
  Serial.print(", Color: (H: ");
  Serial.print(note.color.hue);
  Serial.print(", S: ");
  Serial.print(note.color.sat);
  Serial.print(", V: ");
  Serial.print(note.color.val);
  Serial.println(")>");
}

void displayColumns()
{
  // Clear all LEDs.
  FastLED.clear();

  // Compute the spacing per column.
  int colSpacing = NUM_LEDS / NUM_COLS; // in this case 30

  // Define the colors for each column.
  CRGB colColors[NUM_COLS] = {CRGB::Red, CRGB::Blue, CRGB::Green, CRGB::Orange};

  // Set one LED per column: the first LED in each column will be lit with its assigned color.
  for (int col = 0; col < NUM_COLS; col++)
  {
    int ledIndex = col * colSpacing;
    if (ledIndex < NUM_LEDS)
    {
      leds[ledIndex] = colColors[col];
    }
  }

  // Update the LED strip so that the colors are shown.
  FastLED.show();
}

uint32_t lighter(uint32_t color)
{
  // This is a placeholder. For example, you might simply add some brightness or blend with white.
  // Here we just return a fixed lighter value for illustration.
  return color | 0x303030; // Set lower bits to 1 for a "brighter" color.
}

// Helper function that processes notes for a given column.
bool processNotes(uint8_t buttonColumn, float currentTime)
{
  // Flip buttonColumn
  if (buttonColumn == 0)
    buttonColumn = 3;
  else if (buttonColumn == 1)
    buttonColumn = 2;
  else if (buttonColumn == 2)
    buttonColumn = 1;
  else if (buttonColumn == 3)
    buttonColumn = 0;

  bool hitDetected = false;
  float smallestTime = 1000.0;
  piano_note_t smallestNote;
  for (int i = 0; i < totalNotes; i++)
  {
    if (notes[i].col == buttonColumn)
    {

      // float diff = notes[i].time - currentTime;
      // Note is “nearby” if it is within the threshold.
      if ((currentTime >= (notes[i].time - PIANO_THRESHOLD)) && (currentTime <= (notes[i].time + PIANO_THRESHOLD)))
      {
        notes[i].color = colColorsLighter[buttonColumn];
        notes[i].hit = true;
        hitDetected = true;
        Serial.println("HIT!");
        correctHits++;
      }
    }
  }

  if (!hitDetected)
  {
    Serial.println("No hit, adding damage :(");
    Serial.printf("New damageUntil=%lu\n", damageUntil);
    damageUntil = millis() + 500;
    incorrectHits++;
    if (incorrectHits == MAX_FAILURES)
    {
      taserActivated = true;
    }
  }

  return hitDetected;
}

// Now the modified function that takes booleans for each button.
void handleButtonPress(bool button1, bool button2, bool button3, bool button4)
{
  // Time window threshold for a "nearby" note – 4/5 seconds equals 0.8 sec if WINDOW_LENGTH is 5.

  // Button 1 --> Column "d"
  if (button1)
  {

    if (secondsElapsed - lastHit[PIANO_NOTE_D] >= PIANO_DEBOUNCE_DELAY)
    {
      processNotes(PIANO_NOTE_D, secondsElapsed);
      lastHit[PIANO_NOTE_D] = secondsElapsed;
    }
  }

  // Button 2 --> Column "f"
  if (button2)
  {

    if (secondsElapsed - lastHit[PIANO_NOTE_F] >= PIANO_DEBOUNCE_DELAY)
    {
      processNotes(PIANO_NOTE_F, secondsElapsed);
      lastHit[PIANO_NOTE_F] = secondsElapsed;
    }
  }

  // Button 3 --> Column "j"
  if (button3)
  {

    if (secondsElapsed - lastHit[PIANO_NOTE_J] >= PIANO_DEBOUNCE_DELAY)
    {
      processNotes(PIANO_NOTE_J, secondsElapsed);
      lastHit[PIANO_NOTE_J] = secondsElapsed;
    }
  }

  // Button 4 --> Column "k"
  if (button4)
  {

    if (secondsElapsed - lastHit[PIANO_NOTE_K] >= PIANO_DEBOUNCE_DELAY)
    {
      processNotes(PIANO_NOTE_K, secondsElapsed);
      lastHit[PIANO_NOTE_K] = secondsElapsed;
    }
  }
}

void activateTaser()
{
  digitalWrite(TASER_PIN, HIGH);
  delay(250);
  digitalWrite(TASER_PIN, LOW);
  delay(5000);
  ESP.restart();
}
